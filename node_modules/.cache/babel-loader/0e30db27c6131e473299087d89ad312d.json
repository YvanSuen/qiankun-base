{"remainingRequest":"D:\\qiankun微前台\\Demo\\qiankun\\qiankun-base\\node_modules\\babel-loader\\lib\\index.js!D:\\qiankun微前台\\Demo\\qiankun\\qiankun-base\\node_modules\\qiankun\\es\\sandbox\\proxySandbox.js","dependencies":[{"path":"D:\\qiankun微前台\\Demo\\qiankun\\qiankun-base\\node_modules\\qiankun\\es\\sandbox\\proxySandbox.js","mtime":1631881155000},{"path":"D:\\qiankun微前台\\Demo\\qiankun\\qiankun-base\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1618900774989},{"path":"D:\\qiankun微前台\\Demo\\qiankun\\qiankun-base\\node_modules\\babel-loader\\lib\\index.js","mtime":1618886346176}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktbmFtZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmZyZWV6ZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLnVuc2NvcGFibGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmRlc2NyaXB0aW9uLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVmbGVjdC5vd24ta2V5cy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZmxlY3QuZGVmaW5lLXByb3BlcnR5LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVmbGVjdC5nZXQtcHJvdG90eXBlLW9mLmpzIjsKaW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheSI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IHsgU2FuZEJveFR5cGUgfSBmcm9tICcuLi9pbnRlcmZhY2VzJzsKaW1wb3J0IHsgbmV4dFRhc2sgfSBmcm9tICcuLi91dGlscyc7CmltcG9ydCB7IGdldFRhcmdldFZhbHVlLCBzZXRDdXJyZW50UnVubmluZ0FwcCB9IGZyb20gJy4vY29tbW9uJzsKLyoqCiAqIGZhc3Rlc3QoYXQgbW9zdCB0aW1lKSB1bmlxdWUgYXJyYXkgbWV0aG9kCiAqIEBzZWUgaHR0cHM6Ly9qc3BlcmYuY29tL2FycmF5LWZpbHRlci11bmlxdWUvMzAKICovCgpmdW5jdGlvbiB1bmlxKGFycmF5KSB7CiAgcmV0dXJuIGFycmF5LmZpbHRlcihmdW5jdGlvbiBmaWx0ZXIoZWxlbWVudCkgewogICAgcmV0dXJuIGVsZW1lbnQgaW4gdGhpcyA/IGZhbHNlIDogdGhpc1tlbGVtZW50XSA9IHRydWU7CiAgfSwgT2JqZWN0LmNyZWF0ZShudWxsKSk7Cn0gLy8gem9uZS5qcyB3aWxsIG92ZXJ3cml0ZSBPYmplY3QuZGVmaW5lUHJvcGVydHkKCgp2YXIgcmF3T2JqZWN0RGVmaW5lUHJvcGVydHkgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7CnZhciB2YXJpYWJsZVdoaXRlTGlzdEluRGV2ID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgfHwgd2luZG93Ll9fUUlBTktVTl9ERVZFTE9QTUVOVF9fID8gWy8vIGZvciByZWFjdCBob3QgcmVsb2FkCi8vIHNlZSBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svY3JlYXRlLXJlYWN0LWFwcC9ibG9iLzY2YmY3ZGZjNDMzNTAyNDllMmYwOWQxMzhhMjA4NDBkYWU4YTBhNGEvcGFja2FnZXMvcmVhY3QtZXJyb3Itb3ZlcmxheS9zcmMvaW5kZXguanMjTDE4MAonX19SRUFDVF9FUlJPUl9PVkVSTEFZX0dMT0JBTF9IT09LX18nXSA6IFtdOyAvLyB3aG8gY291bGQgZXNjYXBlIHRoZSBzYW5kYm94Cgp2YXIgdmFyaWFibGVXaGl0ZUxpc3QgPSBbLy8gRklYTUUgU3lzdGVtLmpzIHVzZWQgYSBpbmRpcmVjdCBjYWxsIHdpdGggZXZhbCwgd2hpY2ggd291bGQgbWFrZSBpdCBzY29wZSBlc2NhcGUgdG8gZ2xvYmFsCi8vIFRvIG1ha2UgU3lzdGVtLmpzIHdvcmtzIHdlbGwsIHdlIHdyaXRlIGl0IGJhY2sgdG8gZ2xvYmFsIHdpbmRvdyB0ZW1wb3JhcnkKLy8gc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9zeXN0ZW1qcy9zeXN0ZW1qcy9ibG9iLzQ1N2Y1YjdlOGFmNmJkMTIwYTI3OTU0MDQ3NzU1MmEwN2Q1ZGUwODYvc3JjL2V2YWx1YXRlLmpzI0wxMDYKJ1N5c3RlbScsIC8vIHNlZSBodHRwczovL2dpdGh1Yi5jb20vc3lzdGVtanMvc3lzdGVtanMvYmxvYi80NTdmNWI3ZThhZjZiZDEyMGEyNzk1NDA0Nzc1NTJhMDdkNWRlMDg2L3NyYy9pbnN0YW50aWF0ZS5qcyNMMzU3CidfX2Nqc1dyYXBwZXInXS5jb25jYXQodmFyaWFibGVXaGl0ZUxpc3RJbkRldik7Ci8qCiB2YXJpYWJsZXMgd2hvIGFyZSBpbXBvc3NpYmxlIHRvIGJlIG92ZXJ3cml0ZSBuZWVkIHRvIGJlIGVzY2FwZWQgZnJvbSBwcm94eSBzYW5kYm94IGZvciBwZXJmb3JtYW5jZSByZWFzb25zCiAqLwoKdmFyIHVuc2NvcGFibGVzID0gewogIHVuZGVmaW5lZDogdHJ1ZSwKICBBcnJheTogdHJ1ZSwKICBPYmplY3Q6IHRydWUsCiAgU3RyaW5nOiB0cnVlLAogIEJvb2xlYW46IHRydWUsCiAgTWF0aDogdHJ1ZSwKICBOdW1iZXI6IHRydWUsCiAgU3ltYm9sOiB0cnVlLAogIHBhcnNlRmxvYXQ6IHRydWUsCiAgRmxvYXQzMkFycmF5OiB0cnVlCn07CgpmdW5jdGlvbiBjcmVhdGVGYWtlV2luZG93KGdsb2JhbCkgewogIC8vIG1hcCBhbHdheXMgaGFzIHRoZSBmYXN0ZXN0IHBlcmZvcm1hbmNlIGluIGhhcyBjaGVjayBzY2VuYXJpbwogIC8vIHNlZSBodHRwczovL2pzcGVyZi5jb20vYXJyYXktaW5kZXhvZi12cy1zZXQtaGFzLzIzCiAgdmFyIHByb3BlcnRpZXNXaXRoR2V0dGVyID0gbmV3IE1hcCgpOwogIHZhciBmYWtlV2luZG93ID0ge307CiAgLyoKICAgY29weSB0aGUgbm9uLWNvbmZpZ3VyYWJsZSBwcm9wZXJ0eSBvZiBnbG9iYWwgdG8gZmFrZVdpbmRvdwogICBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvUHJveHkvaGFuZGxlci9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IKICAgPiBBIHByb3BlcnR5IGNhbm5vdCBiZSByZXBvcnRlZCBhcyBub24tY29uZmlndXJhYmxlLCBpZiBpdCBkb2VzIG5vdCBleGlzdHMgYXMgYW4gb3duIHByb3BlcnR5IG9mIHRoZSB0YXJnZXQgb2JqZWN0IG9yIGlmIGl0IGV4aXN0cyBhcyBhIGNvbmZpZ3VyYWJsZSBvd24gcHJvcGVydHkgb2YgdGhlIHRhcmdldCBvYmplY3QuCiAgICovCgogIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGdsb2JhbCkuZmlsdGVyKGZ1bmN0aW9uIChwKSB7CiAgICB2YXIgZGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZ2xvYmFsLCBwKTsKICAgIHJldHVybiAhKGRlc2NyaXB0b3IgPT09IG51bGwgfHwgZGVzY3JpcHRvciA9PT0gdm9pZCAwID8gdm9pZCAwIDogZGVzY3JpcHRvci5jb25maWd1cmFibGUpOwogIH0pLmZvckVhY2goZnVuY3Rpb24gKHApIHsKICAgIHZhciBkZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihnbG9iYWwsIHApOwoKICAgIGlmIChkZXNjcmlwdG9yKSB7CiAgICAgIHZhciBoYXNHZXR0ZXIgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZGVzY3JpcHRvciwgJ2dldCcpOwogICAgICAvKgogICAgICAgbWFrZSB0b3Avc2VsZi93aW5kb3cgcHJvcGVydHkgY29uZmlndXJhYmxlIGFuZCB3cml0YWJsZSwgb3RoZXJ3aXNlIGl0IHdpbGwgY2F1c2UgVHlwZUVycm9yIHdoaWxlIGdldCB0cmFwIHJldHVybi4KICAgICAgIHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9Qcm94eS9oYW5kbGVyL2dldAogICAgICAgPiBUaGUgdmFsdWUgcmVwb3J0ZWQgZm9yIGEgcHJvcGVydHkgbXVzdCBiZSB0aGUgc2FtZSBhcyB0aGUgdmFsdWUgb2YgdGhlIGNvcnJlc3BvbmRpbmcgdGFyZ2V0IG9iamVjdCBwcm9wZXJ0eSBpZiB0aGUgdGFyZ2V0IG9iamVjdCBwcm9wZXJ0eSBpcyBhIG5vbi13cml0YWJsZSwgbm9uLWNvbmZpZ3VyYWJsZSBkYXRhIHByb3BlcnR5LgogICAgICAgKi8KCiAgICAgIGlmIChwID09PSAndG9wJyB8fCBwID09PSAncGFyZW50JyB8fCBwID09PSAnc2VsZicgfHwgcCA9PT0gJ3dpbmRvdycgfHwgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICd0ZXN0JyAmJiAocCA9PT0gJ21vY2tUb3AnIHx8IHAgPT09ICdtb2NrU2FmYXJpVG9wJykpIHsKICAgICAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7CiAgICAgICAgLyoKICAgICAgICAgVGhlIGRlc2NyaXB0b3Igb2Ygd2luZG93LndpbmRvdy93aW5kb3cudG9wL3dpbmRvdy5zZWxmIGluIFNhZmFyaS9GRiBhcmUgYWNjZXNzb3IgZGVzY3JpcHRvcnMsIHdlIG5lZWQgdG8gYXZvaWQgYWRkaW5nIGEgZGF0YSBkZXNjcmlwdG9yIHdoaWxlIGl0IHdhcwogICAgICAgICBFeGFtcGxlOgogICAgICAgICAgU2FmYXJpL0ZGOiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHdpbmRvdywgJ3RvcCcpIC0+IHtnZXQ6IGZ1bmN0aW9uLCBzZXQ6IHVuZGVmaW5lZCwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiBmYWxzZX0KICAgICAgICAgIENocm9tZTogT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih3aW5kb3csICd0b3AnKSAtPiB7dmFsdWU6IFdpbmRvdywgd3JpdGFibGU6IGZhbHNlLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IGZhbHNlfQogICAgICAgICAqLwoKICAgICAgICBpZiAoIWhhc0dldHRlcikgewogICAgICAgICAgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoaGFzR2V0dGVyKSBwcm9wZXJ0aWVzV2l0aEdldHRlci5zZXQocCwgdHJ1ZSk7IC8vIGZyZWV6ZSB0aGUgZGVzY3JpcHRvciB0byBhdm9pZCBiZWluZyBtb2RpZmllZCBieSB6b25lLmpzCiAgICAgIC8vIHNlZSBodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci96b25lLmpzL2Jsb2IvYTVmZTA5YjBmYWMyN2FjNWRmMWZhNzQ2MDQyZjk2ZjA1Y2NiNmEwMC9saWIvYnJvd3Nlci9kZWZpbmUtcHJvcGVydHkudHMjTDcxCgogICAgICByYXdPYmplY3REZWZpbmVQcm9wZXJ0eShmYWtlV2luZG93LCBwLCBPYmplY3QuZnJlZXplKGRlc2NyaXB0b3IpKTsKICAgIH0KICB9KTsKICByZXR1cm4gewogICAgZmFrZVdpbmRvdzogZmFrZVdpbmRvdywKICAgIHByb3BlcnRpZXNXaXRoR2V0dGVyOiBwcm9wZXJ0aWVzV2l0aEdldHRlcgogIH07Cn0KCnZhciBhY3RpdmVTYW5kYm94Q291bnQgPSAwOwovKioKICog5Z+65LqOIFByb3h5IOWunueOsOeahOaymeeusQogKi8KCnZhciBQcm94eVNhbmRib3ggPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFByb3h5U2FuZGJveChuYW1lKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIHZhciBnbG9iYWxDb250ZXh0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB3aW5kb3c7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFByb3h5U2FuZGJveCk7CiAgICAvKiogd2luZG93IOWAvOWPmOabtOiusOW9lSAqLwoKCiAgICB0aGlzLnVwZGF0ZWRWYWx1ZVNldCA9IG5ldyBTZXQoKTsKICAgIHRoaXMuc2FuZGJveFJ1bm5pbmcgPSB0cnVlOwogICAgdGhpcy5sYXRlc3RTZXRQcm9wID0gbnVsbDsKICAgIHRoaXMubmFtZSA9IG5hbWU7CiAgICB0aGlzLmdsb2JhbENvbnRleHQgPSBnbG9iYWxDb250ZXh0OwogICAgdGhpcy50eXBlID0gU2FuZEJveFR5cGUuUHJveHk7CiAgICB2YXIgdXBkYXRlZFZhbHVlU2V0ID0gdGhpcy51cGRhdGVkVmFsdWVTZXQ7CiAgICB2YXIgcmF3V2luZG93ID0gZ2xvYmFsQ29udGV4dDsKCiAgICB2YXIgX2NyZWF0ZUZha2VXaW5kb3cgPSBjcmVhdGVGYWtlV2luZG93KHJhd1dpbmRvdyksCiAgICAgICAgZmFrZVdpbmRvdyA9IF9jcmVhdGVGYWtlV2luZG93LmZha2VXaW5kb3csCiAgICAgICAgcHJvcGVydGllc1dpdGhHZXR0ZXIgPSBfY3JlYXRlRmFrZVdpbmRvdy5wcm9wZXJ0aWVzV2l0aEdldHRlcjsKCiAgICB2YXIgZGVzY3JpcHRvclRhcmdldE1hcCA9IG5ldyBNYXAoKTsKCiAgICB2YXIgaGFzT3duUHJvcGVydHkgPSBmdW5jdGlvbiBoYXNPd25Qcm9wZXJ0eShrZXkpIHsKICAgICAgcmV0dXJuIGZha2VXaW5kb3cuaGFzT3duUHJvcGVydHkoa2V5KSB8fCByYXdXaW5kb3cuaGFzT3duUHJvcGVydHkoa2V5KTsKICAgIH07CgogICAgdmFyIHByb3h5ID0gbmV3IFByb3h5KGZha2VXaW5kb3csIHsKICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodGFyZ2V0LCBwLCB2YWx1ZSkgewogICAgICAgIGlmIChfdGhpcy5zYW5kYm94UnVubmluZykgewogICAgICAgICAgX3RoaXMucmVnaXN0ZXJSdW5uaW5nQXBwKG5hbWUsIHByb3h5KTsgLy8gV2UgbXVzdCBrZXB0IGl0cyBkZXNjcmlwdGlvbiB3aGlsZSB0aGUgcHJvcGVydHkgZXhpc3RlZCBpbiByYXdXaW5kb3cgYmVmb3JlCgoKICAgICAgICAgIGlmICghdGFyZ2V0Lmhhc093blByb3BlcnR5KHApICYmIHJhd1dpbmRvdy5oYXNPd25Qcm9wZXJ0eShwKSkgewogICAgICAgICAgICB2YXIgZGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocmF3V2luZG93LCBwKTsKICAgICAgICAgICAgdmFyIHdyaXRhYmxlID0gZGVzY3JpcHRvci53cml0YWJsZSwKICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZSA9IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlLAogICAgICAgICAgICAgICAgZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZTsKCiAgICAgICAgICAgIGlmICh3cml0YWJsZSkgewogICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIHAsIHsKICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogY29uZmlndXJhYmxlLAogICAgICAgICAgICAgICAgZW51bWVyYWJsZTogZW51bWVyYWJsZSwKICAgICAgICAgICAgICAgIHdyaXRhYmxlOiB3cml0YWJsZSwKICAgICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgICAgIHRhcmdldFtwXSA9IHZhbHVlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh2YXJpYWJsZVdoaXRlTGlzdC5pbmRleE9mKHApICE9PSAtMSkgewogICAgICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgICAgIHJhd1dpbmRvd1twXSA9IHZhbHVlOwogICAgICAgICAgfQoKICAgICAgICAgIHVwZGF0ZWRWYWx1ZVNldC5hZGQocCk7CiAgICAgICAgICBfdGhpcy5sYXRlc3RTZXRQcm9wID0gcDsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnKSB7CiAgICAgICAgICBjb25zb2xlLndhcm4oIltxaWFua3VuXSBTZXQgd2luZG93LiIuY29uY2F0KHAudG9TdHJpbmcoKSwgIiB3aGlsZSBzYW5kYm94IGRlc3Ryb3llZCBvciBpbmFjdGl2ZSBpbiAiKS5jb25jYXQobmFtZSwgIiEiKSk7CiAgICAgICAgfSAvLyDlnKggc3RyaWN0LW1vZGUg5LiL77yMUHJveHkg55qEIGhhbmRsZXIuc2V0IOi/lOWbniBmYWxzZSDkvJrmipvlh7ogVHlwZUVycm9y77yM5Zyo5rKZ566x5Y246L2955qE5oOF5Ya15LiL5bqU6K+l5b+955Wl6ZSZ6K+vCgoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQodGFyZ2V0LCBwKSB7CiAgICAgICAgX3RoaXMucmVnaXN0ZXJSdW5uaW5nQXBwKG5hbWUsIHByb3h5KTsKCiAgICAgICAgaWYgKHAgPT09IFN5bWJvbC51bnNjb3BhYmxlcykgcmV0dXJuIHVuc2NvcGFibGVzOyAvLyBhdm9pZCB3aG8gdXNpbmcgd2luZG93LndpbmRvdyBvciB3aW5kb3cuc2VsZiB0byBlc2NhcGUgdGhlIHNhbmRib3ggZW52aXJvbm1lbnQgdG8gdG91Y2ggdGhlIHJlYWxseSB3aW5kb3cKICAgICAgICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2VsaWdyZXkvRmlsZVNhdmVyLmpzL2Jsb2IvbWFzdGVyL3NyYy9GaWxlU2F2ZXIuanMjTDEzCgogICAgICAgIGlmIChwID09PSAnd2luZG93JyB8fCBwID09PSAnc2VsZicpIHsKICAgICAgICAgIHJldHVybiBwcm94eTsKICAgICAgICB9IC8vIGhpamFjayBnbG9iYWxXaW5kb3cgYWNjZXNzaW5nIHdpdGggZ2xvYmFsVGhpcyBrZXl3b3JkCgoKICAgICAgICBpZiAocCA9PT0gJ2dsb2JhbFRoaXMnKSB7CiAgICAgICAgICByZXR1cm4gcHJveHk7CiAgICAgICAgfQoKICAgICAgICBpZiAocCA9PT0gJ3RvcCcgfHwgcCA9PT0gJ3BhcmVudCcgfHwgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICd0ZXN0JyAmJiAocCA9PT0gJ21vY2tUb3AnIHx8IHAgPT09ICdtb2NrU2FmYXJpVG9wJykpIHsKICAgICAgICAgIC8vIGlmIHlvdXIgbWFzdGVyIGFwcCBpbiBhbiBpZnJhbWUgY29udGV4dCwgYWxsb3cgdGhlc2UgcHJvcHMgZXNjYXBlIHRoZSBzYW5kYm94CiAgICAgICAgICBpZiAocmF3V2luZG93ID09PSByYXdXaW5kb3cucGFyZW50KSB7CiAgICAgICAgICAgIHJldHVybiBwcm94eTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gcmF3V2luZG93W3BdOwogICAgICAgIH0gLy8gcHJveHkuaGFzT3duUHJvcGVydHkgd291bGQgaW52b2tlIGdldHRlciBmaXJzdGx5LCB0aGVuIGl0cyB2YWx1ZSByZXByZXNlbnRlZCBhcyByYXdXaW5kb3cuaGFzT3duUHJvcGVydHkKCgogICAgICAgIGlmIChwID09PSAnaGFzT3duUHJvcGVydHknKSB7CiAgICAgICAgICByZXR1cm4gaGFzT3duUHJvcGVydHk7CiAgICAgICAgfSAvLyBtYXJrIHRoZSBzeW1ib2wgdG8gZG9jdW1lbnQgd2hpbGUgYWNjZXNzaW5nIGFzIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQgY291bGQga25vdyBpcyBpbnZva2VkIGJ5IHdoaWNoIHNhbmRib3ggZm9yIGR5bmFtaWMgYXBwZW5kIHBhdGNoZXIKCgogICAgICAgIGlmIChwID09PSAnZG9jdW1lbnQnIHx8IHAgPT09ICdldmFsJykgewogICAgICAgICAgc3dpdGNoIChwKSB7CiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzoKICAgICAgICAgICAgICByZXR1cm4gZG9jdW1lbnQ7CgogICAgICAgICAgICBjYXNlICdldmFsJzoKICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZXZhbAogICAgICAgICAgICAgIHJldHVybiBldmFsOwogICAgICAgICAgICAvLyBubyBkZWZhdWx0CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tbmVzdGVkLXRlcm5hcnkKCgogICAgICAgIHZhciB2YWx1ZSA9IHByb3BlcnRpZXNXaXRoR2V0dGVyLmhhcyhwKSA/IHJhd1dpbmRvd1twXSA6IHAgaW4gdGFyZ2V0ID8gdGFyZ2V0W3BdIDogcmF3V2luZG93W3BdOwogICAgICAgIHJldHVybiBnZXRUYXJnZXRWYWx1ZShyYXdXaW5kb3csIHZhbHVlKTsKICAgICAgfSwKICAgICAgLy8gdHJhcCBpbiBvcGVyYXRvcgogICAgICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3N0eWxlZC1jb21wb25lbnRzL3N0eWxlZC1jb21wb25lbnRzL2Jsb2IvbWFzdGVyL3BhY2thZ2VzL3N0eWxlZC1jb21wb25lbnRzL3NyYy9jb25zdGFudHMuanMjTDEyCiAgICAgIGhhczogZnVuY3Rpb24gaGFzKHRhcmdldCwgcCkgewogICAgICAgIHJldHVybiBwIGluIHVuc2NvcGFibGVzIHx8IHAgaW4gdGFyZ2V0IHx8IHAgaW4gcmF3V2luZG93OwogICAgICB9LAogICAgICBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I6IGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIHApIHsKICAgICAgICAvKgogICAgICAgICBhcyB0aGUgZGVzY3JpcHRvciBvZiB0b3Avc2VsZi93aW5kb3cvbW9ja1RvcCBpbiByYXcgd2luZG93IGFyZSBjb25maWd1cmFibGUgYnV0IG5vdCBpbiBwcm94eSB0YXJnZXQsIHdlIG5lZWQgdG8gZ2V0IGl0IGZyb20gdGFyZ2V0IHRvIGF2b2lkIFR5cGVFcnJvcgogICAgICAgICBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvUHJveHkvaGFuZGxlci9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IKICAgICAgICAgPiBBIHByb3BlcnR5IGNhbm5vdCBiZSByZXBvcnRlZCBhcyBub24tY29uZmlndXJhYmxlLCBpZiBpdCBkb2VzIG5vdCBleGlzdHMgYXMgYW4gb3duIHByb3BlcnR5IG9mIHRoZSB0YXJnZXQgb2JqZWN0IG9yIGlmIGl0IGV4aXN0cyBhcyBhIGNvbmZpZ3VyYWJsZSBvd24gcHJvcGVydHkgb2YgdGhlIHRhcmdldCBvYmplY3QuCiAgICAgICAgICovCiAgICAgICAgaWYgKHRhcmdldC5oYXNPd25Qcm9wZXJ0eShwKSkgewogICAgICAgICAgdmFyIGRlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwgcCk7CiAgICAgICAgICBkZXNjcmlwdG9yVGFyZ2V0TWFwLnNldChwLCAndGFyZ2V0Jyk7CiAgICAgICAgICByZXR1cm4gZGVzY3JpcHRvcjsKICAgICAgICB9CgogICAgICAgIGlmIChyYXdXaW5kb3cuaGFzT3duUHJvcGVydHkocCkpIHsKICAgICAgICAgIHZhciBfZGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocmF3V2luZG93LCBwKTsKCiAgICAgICAgICBkZXNjcmlwdG9yVGFyZ2V0TWFwLnNldChwLCAncmF3V2luZG93Jyk7IC8vIEEgcHJvcGVydHkgY2Fubm90IGJlIHJlcG9ydGVkIGFzIG5vbi1jb25maWd1cmFibGUsIGlmIGl0IGRvZXMgbm90IGV4aXN0cyBhcyBhbiBvd24gcHJvcGVydHkgb2YgdGhlIHRhcmdldCBvYmplY3QKCiAgICAgICAgICBpZiAoX2Rlc2NyaXB0b3IgJiYgIV9kZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSkgewogICAgICAgICAgICBfZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBfZGVzY3JpcHRvcjsKICAgICAgICB9CgogICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgIH0sCiAgICAgIC8vIHRyYXAgdG8gc3VwcG9ydCBpdGVyYXRvciB3aXRoIHNhbmRib3gKICAgICAgb3duS2V5czogZnVuY3Rpb24gb3duS2V5cyh0YXJnZXQpIHsKICAgICAgICByZXR1cm4gdW5pcShSZWZsZWN0Lm93bktleXMocmF3V2luZG93KS5jb25jYXQoUmVmbGVjdC5vd25LZXlzKHRhcmdldCkpKTsKICAgICAgfSwKICAgICAgZGVmaW5lUHJvcGVydHk6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KHRhcmdldCwgcCwgYXR0cmlidXRlcykgewogICAgICAgIHZhciBmcm9tID0gZGVzY3JpcHRvclRhcmdldE1hcC5nZXQocCk7CiAgICAgICAgLyoKICAgICAgICAgRGVzY3JpcHRvciBtdXN0IGJlIGRlZmluZWQgdG8gbmF0aXZlIHdpbmRvdyB3aGlsZSBpdCBjb21lcyBmcm9tIG5hdGl2ZSB3aW5kb3cgdmlhIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iod2luZG93LCBwKSwKICAgICAgICAgb3RoZXJ3aXNlIGl0IHdvdWxkIGNhdXNlIGEgVHlwZUVycm9yIHdpdGggaWxsZWdhbCBpbnZvY2F0aW9uLgogICAgICAgICAqLwoKICAgICAgICBzd2l0Y2ggKGZyb20pIHsKICAgICAgICAgIGNhc2UgJ3Jhd1dpbmRvdyc6CiAgICAgICAgICAgIHJldHVybiBSZWZsZWN0LmRlZmluZVByb3BlcnR5KHJhd1dpbmRvdywgcCwgYXR0cmlidXRlcyk7CgogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgcmV0dXJuIFJlZmxlY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBwLCBhdHRyaWJ1dGVzKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGRlbGV0ZVByb3BlcnR5OiBmdW5jdGlvbiBkZWxldGVQcm9wZXJ0eSh0YXJnZXQsIHApIHsKICAgICAgICBfdGhpcy5yZWdpc3RlclJ1bm5pbmdBcHAobmFtZSwgcHJveHkpOwoKICAgICAgICBpZiAodGFyZ2V0Lmhhc093blByb3BlcnR5KHApKSB7CiAgICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgICBkZWxldGUgdGFyZ2V0W3BdOwogICAgICAgICAgdXBkYXRlZFZhbHVlU2V0LmRlbGV0ZShwKTsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0sCiAgICAgIC8vIG1ha2VzIHN1cmUgYHdpbmRvdyBpbnN0YW5jZW9mIFdpbmRvd2AgcmV0dXJucyB0cnV0aHkgaW4gbWljcm8gYXBwCiAgICAgIGdldFByb3RvdHlwZU9mOiBmdW5jdGlvbiBnZXRQcm90b3R5cGVPZigpIHsKICAgICAgICByZXR1cm4gUmVmbGVjdC5nZXRQcm90b3R5cGVPZihyYXdXaW5kb3cpOwogICAgICB9CiAgICB9KTsKICAgIHRoaXMucHJveHkgPSBwcm94eTsKICAgIGFjdGl2ZVNhbmRib3hDb3VudCsrOwogIH0KCiAgX2NyZWF0ZUNsYXNzKFByb3h5U2FuZGJveCwgW3sKICAgIGtleTogInJlZ2lzdGVyUnVubmluZ0FwcCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVnaXN0ZXJSdW5uaW5nQXBwKG5hbWUsIHByb3h5KSB7CiAgICAgIGlmICh0aGlzLnNhbmRib3hSdW5uaW5nKSB7CiAgICAgICAgc2V0Q3VycmVudFJ1bm5pbmdBcHAoewogICAgICAgICAgbmFtZTogbmFtZSwKICAgICAgICAgIHdpbmRvdzogcHJveHkKICAgICAgICB9KTsgLy8gRklYTUUgaWYgeW91IGhhdmUgYW55IG90aGVyIGdvb2QgaWRlYXMKICAgICAgICAvLyByZW1vdmUgdGhlIG1hcmsgaW4gbmV4dCB0aWNrLCB0aHVzIHdlIGNhbiBpZGVudGlmeSB3aGV0aGVyIGl0IGluIG1pY3JvIGFwcCBvciBub3QKICAgICAgICAvLyB0aGlzIGFwcHJvYWNoIGlzIGp1c3QgYSB3b3JrYXJvdW5kLCBpdCBjb3VsZCBub3QgY292ZXIgYWxsIGNvbXBsZXggY2FzZXMsIHN1Y2ggYXMgdGhlIG1pY3JvIGFwcCBydW5zIGluIHRoZSBzYW1lIHRhc2sgY29udGV4dCB3aXRoIG1hc3RlciBpbiBzb21lIGNhc2UKCiAgICAgICAgbmV4dFRhc2soZnVuY3Rpb24gKCkgewogICAgICAgICAgc2V0Q3VycmVudFJ1bm5pbmdBcHAobnVsbCk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJhY3RpdmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFjdGl2ZSgpIHsKICAgICAgaWYgKCF0aGlzLnNhbmRib3hSdW5uaW5nKSBhY3RpdmVTYW5kYm94Q291bnQrKzsKICAgICAgdGhpcy5zYW5kYm94UnVubmluZyA9IHRydWU7CiAgICB9CiAgfSwgewogICAga2V5OiAiaW5hY3RpdmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGluYWN0aXZlKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JykgewogICAgICAgIGNvbnNvbGUuaW5mbygiW3FpYW5rdW46c2FuZGJveF0gIi5jb25jYXQodGhpcy5uYW1lLCAiIG1vZGlmaWVkIGdsb2JhbCBwcm9wZXJ0aWVzIHJlc3RvcmUuLi4iKSwgX3RvQ29uc3VtYWJsZUFycmF5KHRoaXMudXBkYXRlZFZhbHVlU2V0LmtleXMoKSkpOwogICAgICB9CgogICAgICBpZiAoLS1hY3RpdmVTYW5kYm94Q291bnQgPT09IDApIHsKICAgICAgICB2YXJpYWJsZVdoaXRlTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChwKSB7CiAgICAgICAgICBpZiAoX3RoaXMyLnByb3h5Lmhhc093blByb3BlcnR5KHApKSB7CiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgICAgICAgZGVsZXRlIF90aGlzMi5nbG9iYWxDb250ZXh0W3BdOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CgogICAgICB0aGlzLnNhbmRib3hSdW5uaW5nID0gZmFsc2U7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gUHJveHlTYW5kYm94Owp9KCk7CgpleHBvcnQgeyBQcm94eVNhbmRib3ggYXMgZGVmYXVsdCB9Ow=="},{"version":3,"sources":["D:/qiankun微前台/Demo/qiankun/qiankun-base/node_modules/qiankun/es/sandbox/proxySandbox.js"],"names":["_toConsumableArray","_classCallCheck","_createClass","SandBoxType","nextTask","getTargetValue","setCurrentRunningApp","uniq","array","filter","element","Object","create","rawObjectDefineProperty","defineProperty","variableWhiteListInDev","process","env","NODE_ENV","window","__QIANKUN_DEVELOPMENT__","variableWhiteList","concat","unscopables","undefined","Array","String","Boolean","Math","Number","Symbol","parseFloat","Float32Array","createFakeWindow","global","propertiesWithGetter","Map","fakeWindow","getOwnPropertyNames","p","descriptor","getOwnPropertyDescriptor","configurable","forEach","hasGetter","prototype","hasOwnProperty","call","writable","set","freeze","activeSandboxCount","ProxySandbox","name","_this","globalContext","arguments","length","updatedValueSet","Set","sandboxRunning","latestSetProp","type","Proxy","rawWindow","_createFakeWindow","descriptorTargetMap","key","proxy","target","value","registerRunningApp","enumerable","indexOf","add","console","warn","toString","get","parent","document","eval","has","_descriptor","ownKeys","Reflect","attributes","from","deleteProperty","delete","getPrototypeOf","active","inactive","_this2","info","keys","default"],"mappings":"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","sourcesContent":["import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport { SandBoxType } from '../interfaces';\nimport { nextTask } from '../utils';\nimport { getTargetValue, setCurrentRunningApp } from './common';\n/**\n * fastest(at most time) unique array method\n * @see https://jsperf.com/array-filter-unique/30\n */\n\nfunction uniq(array) {\n  return array.filter(function filter(element) {\n    return element in this ? false : this[element] = true;\n  }, Object.create(null));\n} // zone.js will overwrite Object.defineProperty\n\n\nvar rawObjectDefineProperty = Object.defineProperty;\nvar variableWhiteListInDev = process.env.NODE_ENV === 'development' || window.__QIANKUN_DEVELOPMENT__ ? [// for react hot reload\n// see https://github.com/facebook/create-react-app/blob/66bf7dfc43350249e2f09d138a20840dae8a0a4a/packages/react-error-overlay/src/index.js#L180\n'__REACT_ERROR_OVERLAY_GLOBAL_HOOK__'] : []; // who could escape the sandbox\n\nvar variableWhiteList = [// FIXME System.js used a indirect call with eval, which would make it scope escape to global\n// To make System.js works well, we write it back to global window temporary\n// see https://github.com/systemjs/systemjs/blob/457f5b7e8af6bd120a279540477552a07d5de086/src/evaluate.js#L106\n'System', // see https://github.com/systemjs/systemjs/blob/457f5b7e8af6bd120a279540477552a07d5de086/src/instantiate.js#L357\n'__cjsWrapper'].concat(variableWhiteListInDev);\n/*\n variables who are impossible to be overwrite need to be escaped from proxy sandbox for performance reasons\n */\n\nvar unscopables = {\n  undefined: true,\n  Array: true,\n  Object: true,\n  String: true,\n  Boolean: true,\n  Math: true,\n  Number: true,\n  Symbol: true,\n  parseFloat: true,\n  Float32Array: true\n};\n\nfunction createFakeWindow(global) {\n  // map always has the fastest performance in has check scenario\n  // see https://jsperf.com/array-indexof-vs-set-has/23\n  var propertiesWithGetter = new Map();\n  var fakeWindow = {};\n  /*\n   copy the non-configurable property of global to fakeWindow\n   see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy/handler/getOwnPropertyDescriptor\n   > A property cannot be reported as non-configurable, if it does not exists as an own property of the target object or if it exists as a configurable own property of the target object.\n   */\n\n  Object.getOwnPropertyNames(global).filter(function (p) {\n    var descriptor = Object.getOwnPropertyDescriptor(global, p);\n    return !(descriptor === null || descriptor === void 0 ? void 0 : descriptor.configurable);\n  }).forEach(function (p) {\n    var descriptor = Object.getOwnPropertyDescriptor(global, p);\n\n    if (descriptor) {\n      var hasGetter = Object.prototype.hasOwnProperty.call(descriptor, 'get');\n      /*\n       make top/self/window property configurable and writable, otherwise it will cause TypeError while get trap return.\n       see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy/handler/get\n       > The value reported for a property must be the same as the value of the corresponding target object property if the target object property is a non-writable, non-configurable data property.\n       */\n\n      if (p === 'top' || p === 'parent' || p === 'self' || p === 'window' || process.env.NODE_ENV === 'test' && (p === 'mockTop' || p === 'mockSafariTop')) {\n        descriptor.configurable = true;\n        /*\n         The descriptor of window.window/window.top/window.self in Safari/FF are accessor descriptors, we need to avoid adding a data descriptor while it was\n         Example:\n          Safari/FF: Object.getOwnPropertyDescriptor(window, 'top') -> {get: function, set: undefined, enumerable: true, configurable: false}\n          Chrome: Object.getOwnPropertyDescriptor(window, 'top') -> {value: Window, writable: false, enumerable: true, configurable: false}\n         */\n\n        if (!hasGetter) {\n          descriptor.writable = true;\n        }\n      }\n\n      if (hasGetter) propertiesWithGetter.set(p, true); // freeze the descriptor to avoid being modified by zone.js\n      // see https://github.com/angular/zone.js/blob/a5fe09b0fac27ac5df1fa746042f96f05ccb6a00/lib/browser/define-property.ts#L71\n\n      rawObjectDefineProperty(fakeWindow, p, Object.freeze(descriptor));\n    }\n  });\n  return {\n    fakeWindow: fakeWindow,\n    propertiesWithGetter: propertiesWithGetter\n  };\n}\n\nvar activeSandboxCount = 0;\n/**\n * 基于 Proxy 实现的沙箱\n */\n\nvar ProxySandbox = /*#__PURE__*/function () {\n  function ProxySandbox(name) {\n    var _this = this;\n\n    var globalContext = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : window;\n\n    _classCallCheck(this, ProxySandbox);\n\n    /** window 值变更记录 */\n    this.updatedValueSet = new Set();\n    this.sandboxRunning = true;\n    this.latestSetProp = null;\n    this.name = name;\n    this.globalContext = globalContext;\n    this.type = SandBoxType.Proxy;\n    var updatedValueSet = this.updatedValueSet;\n    var rawWindow = globalContext;\n\n    var _createFakeWindow = createFakeWindow(rawWindow),\n        fakeWindow = _createFakeWindow.fakeWindow,\n        propertiesWithGetter = _createFakeWindow.propertiesWithGetter;\n\n    var descriptorTargetMap = new Map();\n\n    var hasOwnProperty = function hasOwnProperty(key) {\n      return fakeWindow.hasOwnProperty(key) || rawWindow.hasOwnProperty(key);\n    };\n\n    var proxy = new Proxy(fakeWindow, {\n      set: function set(target, p, value) {\n        if (_this.sandboxRunning) {\n          _this.registerRunningApp(name, proxy); // We must kept its description while the property existed in rawWindow before\n\n\n          if (!target.hasOwnProperty(p) && rawWindow.hasOwnProperty(p)) {\n            var descriptor = Object.getOwnPropertyDescriptor(rawWindow, p);\n            var writable = descriptor.writable,\n                configurable = descriptor.configurable,\n                enumerable = descriptor.enumerable;\n\n            if (writable) {\n              Object.defineProperty(target, p, {\n                configurable: configurable,\n                enumerable: enumerable,\n                writable: writable,\n                value: value\n              });\n            }\n          } else {\n            // @ts-ignore\n            target[p] = value;\n          }\n\n          if (variableWhiteList.indexOf(p) !== -1) {\n            // @ts-ignore\n            rawWindow[p] = value;\n          }\n\n          updatedValueSet.add(p);\n          _this.latestSetProp = p;\n          return true;\n        }\n\n        if (process.env.NODE_ENV === 'development') {\n          console.warn(\"[qiankun] Set window.\".concat(p.toString(), \" while sandbox destroyed or inactive in \").concat(name, \"!\"));\n        } // 在 strict-mode 下，Proxy 的 handler.set 返回 false 会抛出 TypeError，在沙箱卸载的情况下应该忽略错误\n\n\n        return true;\n      },\n      get: function get(target, p) {\n        _this.registerRunningApp(name, proxy);\n\n        if (p === Symbol.unscopables) return unscopables; // avoid who using window.window or window.self to escape the sandbox environment to touch the really window\n        // see https://github.com/eligrey/FileSaver.js/blob/master/src/FileSaver.js#L13\n\n        if (p === 'window' || p === 'self') {\n          return proxy;\n        } // hijack globalWindow accessing with globalThis keyword\n\n\n        if (p === 'globalThis') {\n          return proxy;\n        }\n\n        if (p === 'top' || p === 'parent' || process.env.NODE_ENV === 'test' && (p === 'mockTop' || p === 'mockSafariTop')) {\n          // if your master app in an iframe context, allow these props escape the sandbox\n          if (rawWindow === rawWindow.parent) {\n            return proxy;\n          }\n\n          return rawWindow[p];\n        } // proxy.hasOwnProperty would invoke getter firstly, then its value represented as rawWindow.hasOwnProperty\n\n\n        if (p === 'hasOwnProperty') {\n          return hasOwnProperty;\n        } // mark the symbol to document while accessing as document.createElement could know is invoked by which sandbox for dynamic append patcher\n\n\n        if (p === 'document' || p === 'eval') {\n          switch (p) {\n            case 'document':\n              return document;\n\n            case 'eval':\n              // eslint-disable-next-line no-eval\n              return eval;\n            // no default\n          }\n        } // eslint-disable-next-line no-nested-ternary\n\n\n        var value = propertiesWithGetter.has(p) ? rawWindow[p] : p in target ? target[p] : rawWindow[p];\n        return getTargetValue(rawWindow, value);\n      },\n      // trap in operator\n      // see https://github.com/styled-components/styled-components/blob/master/packages/styled-components/src/constants.js#L12\n      has: function has(target, p) {\n        return p in unscopables || p in target || p in rawWindow;\n      },\n      getOwnPropertyDescriptor: function getOwnPropertyDescriptor(target, p) {\n        /*\n         as the descriptor of top/self/window/mockTop in raw window are configurable but not in proxy target, we need to get it from target to avoid TypeError\n         see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy/handler/getOwnPropertyDescriptor\n         > A property cannot be reported as non-configurable, if it does not exists as an own property of the target object or if it exists as a configurable own property of the target object.\n         */\n        if (target.hasOwnProperty(p)) {\n          var descriptor = Object.getOwnPropertyDescriptor(target, p);\n          descriptorTargetMap.set(p, 'target');\n          return descriptor;\n        }\n\n        if (rawWindow.hasOwnProperty(p)) {\n          var _descriptor = Object.getOwnPropertyDescriptor(rawWindow, p);\n\n          descriptorTargetMap.set(p, 'rawWindow'); // A property cannot be reported as non-configurable, if it does not exists as an own property of the target object\n\n          if (_descriptor && !_descriptor.configurable) {\n            _descriptor.configurable = true;\n          }\n\n          return _descriptor;\n        }\n\n        return undefined;\n      },\n      // trap to support iterator with sandbox\n      ownKeys: function ownKeys(target) {\n        return uniq(Reflect.ownKeys(rawWindow).concat(Reflect.ownKeys(target)));\n      },\n      defineProperty: function defineProperty(target, p, attributes) {\n        var from = descriptorTargetMap.get(p);\n        /*\n         Descriptor must be defined to native window while it comes from native window via Object.getOwnPropertyDescriptor(window, p),\n         otherwise it would cause a TypeError with illegal invocation.\n         */\n\n        switch (from) {\n          case 'rawWindow':\n            return Reflect.defineProperty(rawWindow, p, attributes);\n\n          default:\n            return Reflect.defineProperty(target, p, attributes);\n        }\n      },\n      deleteProperty: function deleteProperty(target, p) {\n        _this.registerRunningApp(name, proxy);\n\n        if (target.hasOwnProperty(p)) {\n          // @ts-ignore\n          delete target[p];\n          updatedValueSet.delete(p);\n          return true;\n        }\n\n        return true;\n      },\n      // makes sure `window instanceof Window` returns truthy in micro app\n      getPrototypeOf: function getPrototypeOf() {\n        return Reflect.getPrototypeOf(rawWindow);\n      }\n    });\n    this.proxy = proxy;\n    activeSandboxCount++;\n  }\n\n  _createClass(ProxySandbox, [{\n    key: \"registerRunningApp\",\n    value: function registerRunningApp(name, proxy) {\n      if (this.sandboxRunning) {\n        setCurrentRunningApp({\n          name: name,\n          window: proxy\n        }); // FIXME if you have any other good ideas\n        // remove the mark in next tick, thus we can identify whether it in micro app or not\n        // this approach is just a workaround, it could not cover all complex cases, such as the micro app runs in the same task context with master in some case\n\n        nextTask(function () {\n          setCurrentRunningApp(null);\n        });\n      }\n    }\n  }, {\n    key: \"active\",\n    value: function active() {\n      if (!this.sandboxRunning) activeSandboxCount++;\n      this.sandboxRunning = true;\n    }\n  }, {\n    key: \"inactive\",\n    value: function inactive() {\n      var _this2 = this;\n\n      if (process.env.NODE_ENV === 'development') {\n        console.info(\"[qiankun:sandbox] \".concat(this.name, \" modified global properties restore...\"), _toConsumableArray(this.updatedValueSet.keys()));\n      }\n\n      if (--activeSandboxCount === 0) {\n        variableWhiteList.forEach(function (p) {\n          if (_this2.proxy.hasOwnProperty(p)) {\n            // @ts-ignore\n            delete _this2.globalContext[p];\n          }\n        });\n      }\n\n      this.sandboxRunning = false;\n    }\n  }]);\n\n  return ProxySandbox;\n}();\n\nexport { ProxySandbox as default };"]}]}