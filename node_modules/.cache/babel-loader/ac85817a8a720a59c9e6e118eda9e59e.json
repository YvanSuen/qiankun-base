{"remainingRequest":"D:\\qiankun微前台\\Demo\\qiankun\\qiankun-base\\node_modules\\babel-loader\\lib\\index.js!D:\\qiankun微前台\\Demo\\qiankun\\qiankun-base\\node_modules\\qiankun\\es\\sandbox\\common.js","dependencies":[{"path":"D:\\qiankun微前台\\Demo\\qiankun\\qiankun-base\\node_modules\\qiankun\\es\\sandbox\\common.js","mtime":1631881155000},{"path":"D:\\qiankun微前台\\Demo\\qiankun\\qiankun-base\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1618900774989},{"path":"D:\\qiankun微前台\\Demo\\qiankun\\qiankun-base\\node_modules\\babel-loader\\lib\\index.js","mtime":1618886346176}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLndlYWstbWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvci5qcyI7CgovKioKICogQGF1dGhvciBLdWl0b3MKICogQHNpbmNlIDIwMjAtMDQtMTMKICovCmltcG9ydCB7IGlzQm91bmRlZEZ1bmN0aW9uLCBpc0NhbGxhYmxlLCBpc0NvbnN0cnVjdGFibGUgfSBmcm9tICcuLi91dGlscyc7CnZhciBjdXJyZW50UnVubmluZ0FwcCA9IG51bGw7Ci8qKgogKiBnZXQgdGhlIGFwcCB0aGF0IHJ1bm5pbmcgdGFza3MgYXQgY3VycmVudCB0aWNrCiAqLwoKZXhwb3J0IGZ1bmN0aW9uIGdldEN1cnJlbnRSdW5uaW5nQXBwKCkgewogIHJldHVybiBjdXJyZW50UnVubmluZ0FwcDsKfQpleHBvcnQgZnVuY3Rpb24gc2V0Q3VycmVudFJ1bm5pbmdBcHAoYXBwSW5zdGFuY2UpIHsKICAvLyBzZXQgY3VycmVudFJ1bm5pbmdBcHAgYW5kIGl0J3MgcHJveHlTYW5kYm94IHRvIGdsb2JhbCB3aW5kb3csIGFzIGl0cyBvbmx5IHVzZSBjYXNlIGlzIGZvciBkb2N1bWVudC5jcmVhdGVFbGVtZW50IGZyb20gbm93IG9uLCB3aGljaCBoaWphY2tlZCBieSBhIGdsb2JhbCB3YXkKICBjdXJyZW50UnVubmluZ0FwcCA9IGFwcEluc3RhbmNlOwp9CnZhciBmdW5jdGlvbkJvdW5kZWRWYWx1ZU1hcCA9IG5ldyBXZWFrTWFwKCk7CmV4cG9ydCBmdW5jdGlvbiBnZXRUYXJnZXRWYWx1ZSh0YXJnZXQsIHZhbHVlKSB7CiAgLyoKICAgIOS7hee7keWumiBpc0NhbGxhYmxlICYmICFpc0JvdW5kZWRGdW5jdGlvbiAmJiAhaXNDb25zdHJ1Y3RhYmxlIOeahOWHveaVsOWvueixoe+8jOWmgiB3aW5kb3cuY29uc29sZeOAgXdpbmRvdy5hdG9iIOi/meexu++8jOS4jeeEtuW+ruW6lOeUqOS4reiwg+eUqOaXtuS8muaKm+WHuiBJbGxlZ2FsIGludm9jYXRpb24g5byC5bi4CiAgICDnm67liY3msqHmnInlroznvo7nmoTmo4DmtYvmlrnlvI/vvIzov5nph4zpgJrov4cgcHJvdG90eXBlIOS4reaYr+WQpui/mOacieWPr+aemuS4vueahOaLk+WxleaWueazleeahOaWueW8j+adpeWIpOaWrQogICAgQHdhcm5pbmcg6L+Z6YeM5LiN6KaB6ZqP5oSP5pu/5o2i5oiQ5Yir55qE5Yik5pat5pa55byP77yM5Zug5Li65Y+v6IO96Kem5Y+R5LiA5LqbIGVkZ2UgY2FzZe+8iOavlOWmguWcqCBsb2Rhc2guaXNGdW5jdGlvbiDlnKggaWZyYW1lIOS4iuS4i+aWh+S4reWPr+iDveeUseS6juiwg+eUqOS6hiB0b3Agd2luZG93IOWvueixoeinpuWPkeeahOWuieWFqOW8guW4uO+8iQogICAqLwogIGlmIChpc0NhbGxhYmxlKHZhbHVlKSAmJiAhaXNCb3VuZGVkRnVuY3Rpb24odmFsdWUpICYmICFpc0NvbnN0cnVjdGFibGUodmFsdWUpKSB7CiAgICB2YXIgY2FjaGVkQm91bmRGdW5jdGlvbiA9IGZ1bmN0aW9uQm91bmRlZFZhbHVlTWFwLmdldCh2YWx1ZSk7CgogICAgaWYgKGNhY2hlZEJvdW5kRnVuY3Rpb24pIHsKICAgICAgcmV0dXJuIGNhY2hlZEJvdW5kRnVuY3Rpb247CiAgICB9CgogICAgdmFyIGJvdW5kVmFsdWUgPSBGdW5jdGlvbi5wcm90b3R5cGUuYmluZC5jYWxsKHZhbHVlLCB0YXJnZXQpOyAvLyBzb21lIGNhbGxhYmxlIGZ1bmN0aW9uIGhhcyBjdXN0b20gZmllbGRzLCB3ZSBuZWVkIHRvIGNvcHkgdGhlIGVudW1lcmFibGUgcHJvcHMgdG8gYm91bmRWYWx1ZS4gc3VjaCBhcyBtb21lbnQgZnVuY3Rpb24uCiAgICAvLyB1c2UgZm9yLi5pbiByYXRoZXIgdGhhbiBPYmplY3Qua2V5cy5mb3JFYWNoIGZvciBwZXJmb3JtYW5jZSByZWFzb24KICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBndWFyZC1mb3ItaW4sbm8tcmVzdHJpY3RlZC1zeW50YXgKCiAgICBmb3IgKHZhciBrZXkgaW4gdmFsdWUpIHsKICAgICAgYm91bmRWYWx1ZVtrZXldID0gdmFsdWVba2V5XTsKICAgIH0gLy8gY29weSBwcm90b3R5cGUgaWYgYm91bmQgZnVuY3Rpb24gbm90IGhhdmUgYnV0IHRhcmdldCBvbmUgaGF2ZQogICAgLy8gYXMgcHJvdG90eXBlIGlzIG5vbi1lbnVtZXJhYmxlIG1vc3RseSwgd2UgbmVlZCB0byBjb3B5IGl0IGZyb20gdGFyZ2V0IGZ1bmN0aW9uIG1hbnVhbGx5CgoKICAgIGlmICh2YWx1ZS5oYXNPd25Qcm9wZXJ0eSgncHJvdG90eXBlJykgJiYgIWJvdW5kVmFsdWUuaGFzT3duUHJvcGVydHkoJ3Byb3RvdHlwZScpKSB7CiAgICAgIC8vIHdlIHNob3VsZCBub3QgdXNlIGFzc2lnbm1lbnQgb3BlcmF0b3IgdG8gc2V0IGJvdW5kVmFsdWUgcHJvdG90eXBlIGxpa2UgYGJvdW5kVmFsdWUucHJvdG90eXBlID0gdmFsdWUucHJvdG90eXBlYAogICAgICAvLyBhcyB0aGUgYXNzaWdubWVudCB3aWxsIGFsc28gbG9vayB1cCBwcm90b3R5cGUgY2hhaW4gd2hpbGUgaXQgaGFzbid0IG93biBwcm90b3R5cGUgcHJvcGVydHksCiAgICAgIC8vIHdoZW4gdGhlIGxvb2t1cCBzdWNjZWVkLCB0aGUgYXNzaWdubWVudCB3aWxsIHRocm93IGFuIFR5cGVFcnJvciBsaWtlIGBDYW5ub3QgYXNzaWduIHRvIHJlYWQgb25seSBwcm9wZXJ0eSAncHJvdG90eXBlJyBvZiBmdW5jdGlvbmAgaWYgaXRzIGRlc2NyaXB0b3IgY29uZmlndXJlZCB3aXRoIHdyaXRhYmxlIGZhbHNlIG9yIGp1c3QgaGF2ZSBhIGdldHRlciBhY2Nlc3NvcgogICAgICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3VtaWpzL3FpYW5rdW4vaXNzdWVzLzExMjEKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGJvdW5kVmFsdWUsICdwcm90b3R5cGUnLCB7CiAgICAgICAgdmFsdWU6IHZhbHVlLnByb3RvdHlwZSwKICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZQogICAgICB9KTsKICAgIH0KCiAgICBmdW5jdGlvbkJvdW5kZWRWYWx1ZU1hcC5zZXQodmFsdWUsIGJvdW5kVmFsdWUpOwogICAgcmV0dXJuIGJvdW5kVmFsdWU7CiAgfQoKICByZXR1cm4gdmFsdWU7Cn0KdmFyIGdldHRlckludm9jYXRpb25SZXN1bHRNYXAgPSBuZXcgV2Vha01hcCgpOwpleHBvcnQgZnVuY3Rpb24gZ2V0UHJveHlQcm9wZXJ0eVZhbHVlKGdldHRlcikgewogIHZhciBnZXR0ZXJSZXN1bHQgPSBnZXR0ZXJJbnZvY2F0aW9uUmVzdWx0TWFwLmdldChnZXR0ZXIpOwoKICBpZiAoIWdldHRlclJlc3VsdCkgewogICAgdmFyIHJlc3VsdCA9IGdldHRlcigpOwogICAgZ2V0dGVySW52b2NhdGlvblJlc3VsdE1hcC5zZXQoZ2V0dGVyLCByZXN1bHQpOwogICAgcmV0dXJuIHJlc3VsdDsKICB9CgogIHJldHVybiBnZXR0ZXJSZXN1bHQ7Cn0="},{"version":3,"sources":["D:/qiankun微前台/Demo/qiankun/qiankun-base/node_modules/qiankun/es/sandbox/common.js"],"names":["isBoundedFunction","isCallable","isConstructable","currentRunningApp","getCurrentRunningApp","setCurrentRunningApp","appInstance","functionBoundedValueMap","WeakMap","getTargetValue","target","value","cachedBoundFunction","get","boundValue","Function","prototype","bind","call","key","hasOwnProperty","Object","defineProperty","enumerable","writable","set","getterInvocationResultMap","getProxyPropertyValue","getter","getterResult","result"],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA,SAASA,iBAAT,EAA4BC,UAA5B,EAAwCC,eAAxC,QAA+D,UAA/D;AACA,IAAIC,iBAAiB,GAAG,IAAxB;AACA;AACA;AACA;;AAEA,OAAO,SAASC,oBAAT,GAAgC;AACrC,SAAOD,iBAAP;AACD;AACD,OAAO,SAASE,oBAAT,CAA8BC,WAA9B,EAA2C;AAChD;AACAH,EAAAA,iBAAiB,GAAGG,WAApB;AACD;AACD,IAAIC,uBAAuB,GAAG,IAAIC,OAAJ,EAA9B;AACA,OAAO,SAASC,cAAT,CAAwBC,MAAxB,EAAgCC,KAAhC,EAAuC;AAC5C;AACF;AACA;AACA;AACA;AACE,MAAIV,UAAU,CAACU,KAAD,CAAV,IAAqB,CAACX,iBAAiB,CAACW,KAAD,CAAvC,IAAkD,CAACT,eAAe,CAACS,KAAD,CAAtE,EAA+E;AAC7E,QAAIC,mBAAmB,GAAGL,uBAAuB,CAACM,GAAxB,CAA4BF,KAA5B,CAA1B;;AAEA,QAAIC,mBAAJ,EAAyB;AACvB,aAAOA,mBAAP;AACD;;AAED,QAAIE,UAAU,GAAGC,QAAQ,CAACC,SAAT,CAAmBC,IAAnB,CAAwBC,IAAxB,CAA6BP,KAA7B,EAAoCD,MAApC,CAAjB,CAP6E,CAOf;AAC9D;AACA;;AAEA,SAAK,IAAIS,GAAT,IAAgBR,KAAhB,EAAuB;AACrBG,MAAAA,UAAU,CAACK,GAAD,CAAV,GAAkBR,KAAK,CAACQ,GAAD,CAAvB;AACD,KAb4E,CAa3E;AACF;;;AAGA,QAAIR,KAAK,CAACS,cAAN,CAAqB,WAArB,KAAqC,CAACN,UAAU,CAACM,cAAX,CAA0B,WAA1B,CAA1C,EAAkF;AAChF;AACA;AACA;AACA;AACAC,MAAAA,MAAM,CAACC,cAAP,CAAsBR,UAAtB,EAAkC,WAAlC,EAA+C;AAC7CH,QAAAA,KAAK,EAAEA,KAAK,CAACK,SADgC;AAE7CO,QAAAA,UAAU,EAAE,KAFiC;AAG7CC,QAAAA,QAAQ,EAAE;AAHmC,OAA/C;AAKD;;AAEDjB,IAAAA,uBAAuB,CAACkB,GAAxB,CAA4Bd,KAA5B,EAAmCG,UAAnC;AACA,WAAOA,UAAP;AACD;;AAED,SAAOH,KAAP;AACD;AACD,IAAIe,yBAAyB,GAAG,IAAIlB,OAAJ,EAAhC;AACA,OAAO,SAASmB,qBAAT,CAA+BC,MAA/B,EAAuC;AAC5C,MAAIC,YAAY,GAAGH,yBAAyB,CAACb,GAA1B,CAA8Be,MAA9B,CAAnB;;AAEA,MAAI,CAACC,YAAL,EAAmB;AACjB,QAAIC,MAAM,GAAGF,MAAM,EAAnB;AACAF,IAAAA,yBAAyB,CAACD,GAA1B,CAA8BG,MAA9B,EAAsCE,MAAtC;AACA,WAAOA,MAAP;AACD;;AAED,SAAOD,YAAP;AACD","sourcesContent":["/**\n * @author Kuitos\n * @since 2020-04-13\n */\nimport { isBoundedFunction, isCallable, isConstructable } from '../utils';\nvar currentRunningApp = null;\n/**\n * get the app that running tasks at current tick\n */\n\nexport function getCurrentRunningApp() {\n  return currentRunningApp;\n}\nexport function setCurrentRunningApp(appInstance) {\n  // set currentRunningApp and it's proxySandbox to global window, as its only use case is for document.createElement from now on, which hijacked by a global way\n  currentRunningApp = appInstance;\n}\nvar functionBoundedValueMap = new WeakMap();\nexport function getTargetValue(target, value) {\n  /*\n    仅绑定 isCallable && !isBoundedFunction && !isConstructable 的函数对象，如 window.console、window.atob 这类，不然微应用中调用时会抛出 Illegal invocation 异常\n    目前没有完美的检测方式，这里通过 prototype 中是否还有可枚举的拓展方法的方式来判断\n    @warning 这里不要随意替换成别的判断方式，因为可能触发一些 edge case（比如在 lodash.isFunction 在 iframe 上下文中可能由于调用了 top window 对象触发的安全异常）\n   */\n  if (isCallable(value) && !isBoundedFunction(value) && !isConstructable(value)) {\n    var cachedBoundFunction = functionBoundedValueMap.get(value);\n\n    if (cachedBoundFunction) {\n      return cachedBoundFunction;\n    }\n\n    var boundValue = Function.prototype.bind.call(value, target); // some callable function has custom fields, we need to copy the enumerable props to boundValue. such as moment function.\n    // use for..in rather than Object.keys.forEach for performance reason\n    // eslint-disable-next-line guard-for-in,no-restricted-syntax\n\n    for (var key in value) {\n      boundValue[key] = value[key];\n    } // copy prototype if bound function not have but target one have\n    // as prototype is non-enumerable mostly, we need to copy it from target function manually\n\n\n    if (value.hasOwnProperty('prototype') && !boundValue.hasOwnProperty('prototype')) {\n      // we should not use assignment operator to set boundValue prototype like `boundValue.prototype = value.prototype`\n      // as the assignment will also look up prototype chain while it hasn't own prototype property,\n      // when the lookup succeed, the assignment will throw an TypeError like `Cannot assign to read only property 'prototype' of function` if its descriptor configured with writable false or just have a getter accessor\n      // see https://github.com/umijs/qiankun/issues/1121\n      Object.defineProperty(boundValue, 'prototype', {\n        value: value.prototype,\n        enumerable: false,\n        writable: true\n      });\n    }\n\n    functionBoundedValueMap.set(value, boundValue);\n    return boundValue;\n  }\n\n  return value;\n}\nvar getterInvocationResultMap = new WeakMap();\nexport function getProxyPropertyValue(getter) {\n  var getterResult = getterInvocationResultMap.get(getter);\n\n  if (!getterResult) {\n    var result = getter();\n    getterInvocationResultMap.set(getter, result);\n    return result;\n  }\n\n  return getterResult;\n}"]}]}