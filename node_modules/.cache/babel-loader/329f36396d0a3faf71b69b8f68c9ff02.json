{"remainingRequest":"D:\\qiankun微前台\\Demo\\qiankun\\qiankun-base\\node_modules\\babel-loader\\lib\\index.js!D:\\qiankun微前台\\Demo\\qiankun\\qiankun-base\\node_modules\\qiankun\\es\\sandbox\\patchers\\css.js","dependencies":[{"path":"D:\\qiankun微前台\\Demo\\qiankun\\qiankun-base\\node_modules\\qiankun\\es\\sandbox\\patchers\\css.js","mtime":1631881155000},{"path":"D:\\qiankun微前台\\Demo\\qiankun\\qiankun-base\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1618900774989},{"path":"D:\\qiankun微前台\\Demo\\qiankun\\qiankun-base\\node_modules\\babel-loader\\lib\\index.js","mtime":1618886346176}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnRyaW0uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7Ci8qKgogKiBAYXV0aG9yIFNhdmlpbwogKiBAc2luY2UgMjAyMC00LTE5CiAqLwovLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvQ1NTUnVsZQoKdmFyIFJ1bGVUeXBlOwoKKGZ1bmN0aW9uIChSdWxlVHlwZSkgewogIC8vIHR5cGU6IHJ1bGUgd2lsbCBiZSByZXdyb3RlCiAgUnVsZVR5cGVbUnVsZVR5cGVbIlNUWUxFIl0gPSAxXSA9ICJTVFlMRSI7CiAgUnVsZVR5cGVbUnVsZVR5cGVbIk1FRElBIl0gPSA0XSA9ICJNRURJQSI7CiAgUnVsZVR5cGVbUnVsZVR5cGVbIlNVUFBPUlRTIl0gPSAxMl0gPSAiU1VQUE9SVFMiOyAvLyB0eXBlOiB2YWx1ZSB3aWxsIGJlIGtlcHQKCiAgUnVsZVR5cGVbUnVsZVR5cGVbIklNUE9SVCJdID0gM10gPSAiSU1QT1JUIjsKICBSdWxlVHlwZVtSdWxlVHlwZVsiRk9OVF9GQUNFIl0gPSA1XSA9ICJGT05UX0ZBQ0UiOwogIFJ1bGVUeXBlW1J1bGVUeXBlWyJQQUdFIl0gPSA2XSA9ICJQQUdFIjsKICBSdWxlVHlwZVtSdWxlVHlwZVsiS0VZRlJBTUVTIl0gPSA3XSA9ICJLRVlGUkFNRVMiOwogIFJ1bGVUeXBlW1J1bGVUeXBlWyJLRVlGUkFNRSJdID0gOF0gPSAiS0VZRlJBTUUiOwp9KShSdWxlVHlwZSB8fCAoUnVsZVR5cGUgPSB7fSkpOwoKdmFyIGFycmF5aWZ5ID0gZnVuY3Rpb24gYXJyYXlpZnkobGlzdCkgewogIHJldHVybiBbXS5zbGljZS5jYWxsKGxpc3QsIDApOwp9OwoKdmFyIHJhd0RvY3VtZW50Qm9keUFwcGVuZCA9IEhUTUxCb2R5RWxlbWVudC5wcm90b3R5cGUuYXBwZW5kQ2hpbGQ7CmV4cG9ydCB2YXIgU2NvcGVkQ1NTID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBTY29wZWRDU1MoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU2NvcGVkQ1NTKTsKCiAgICB2YXIgc3R5bGVOb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsKICAgIHJhd0RvY3VtZW50Qm9keUFwcGVuZC5jYWxsKGRvY3VtZW50LmJvZHksIHN0eWxlTm9kZSk7CiAgICB0aGlzLnN3YXBOb2RlID0gc3R5bGVOb2RlOwogICAgdGhpcy5zaGVldCA9IHN0eWxlTm9kZS5zaGVldDsKICAgIHRoaXMuc2hlZXQuZGlzYWJsZWQgPSB0cnVlOwogIH0KCiAgX2NyZWF0ZUNsYXNzKFNjb3BlZENTUywgW3sKICAgIGtleTogInByb2Nlc3MiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHByb2Nlc3Moc3R5bGVOb2RlKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgcHJlZml4ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiAnJzsKCiAgICAgIHZhciBfYTsKCiAgICAgIGlmIChzdHlsZU5vZGUudGV4dENvbnRlbnQgIT09ICcnKSB7CiAgICAgICAgdmFyIHRleHROb2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoc3R5bGVOb2RlLnRleHRDb250ZW50IHx8ICcnKTsKICAgICAgICB0aGlzLnN3YXBOb2RlLmFwcGVuZENoaWxkKHRleHROb2RlKTsKICAgICAgICB2YXIgc2hlZXQgPSB0aGlzLnN3YXBOb2RlLnNoZWV0OyAvLyB0eXBlIGlzIG1pc3NpbmcKCiAgICAgICAgdmFyIHJ1bGVzID0gYXJyYXlpZnkoKF9hID0gc2hlZXQgPT09IG51bGwgfHwgc2hlZXQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHNoZWV0LmNzc1J1bGVzKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBbXSk7CiAgICAgICAgdmFyIGNzcyA9IHRoaXMucmV3cml0ZShydWxlcywgcHJlZml4KTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduCgogICAgICAgIHN0eWxlTm9kZS50ZXh0Q29udGVudCA9IGNzczsgLy8gY2xlYW51cAoKICAgICAgICB0aGlzLnN3YXBOb2RlLnJlbW92ZUNoaWxkKHRleHROb2RlKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBtdXRhdG9yID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24gKG11dGF0aW9ucykgewogICAgICAgIHZhciBfYTsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtdXRhdGlvbnMubGVuZ3RoOyBpICs9IDEpIHsKICAgICAgICAgIHZhciBtdXRhdGlvbiA9IG11dGF0aW9uc1tpXTsKCiAgICAgICAgICBpZiAoU2NvcGVkQ1NTLk1vZGlmaWVkVGFnIGluIHN0eWxlTm9kZSkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKG11dGF0aW9uLnR5cGUgPT09ICdjaGlsZExpc3QnKSB7CiAgICAgICAgICAgIHZhciBfc2hlZXQgPSBzdHlsZU5vZGUuc2hlZXQ7CgogICAgICAgICAgICB2YXIgX3J1bGVzID0gYXJyYXlpZnkoKF9hID0gX3NoZWV0ID09PSBudWxsIHx8IF9zaGVldCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3NoZWV0LmNzc1J1bGVzKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBbXSk7CgogICAgICAgICAgICB2YXIgX2NzcyA9IF90aGlzLnJld3JpdGUoX3J1bGVzLCBwcmVmaXgpOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ24KCgogICAgICAgICAgICBzdHlsZU5vZGUudGV4dENvbnRlbnQgPSBfY3NzOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ24KCiAgICAgICAgICAgIHN0eWxlTm9kZVtTY29wZWRDU1MuTW9kaWZpZWRUYWddID0gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOyAvLyBzaW5jZSBvYnNlcnZlciB3aWxsIGJlIGRlbGV0ZWQgd2hlbiBub2RlIGJlIHJlbW92ZWQKICAgICAgLy8gd2UgZG9udCBuZWVkIGNyZWF0ZSBhIGNsZWFudXAgZnVuY3Rpb24gbWFudWFsbHkKICAgICAgLy8gc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9NdXRhdGlvbk9ic2VydmVyL2Rpc2Nvbm5lY3QKCiAgICAgIG11dGF0b3Iub2JzZXJ2ZShzdHlsZU5vZGUsIHsKICAgICAgICBjaGlsZExpc3Q6IHRydWUKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmV3cml0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmV3cml0ZShydWxlcykgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBwcmVmaXggPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6ICcnOwogICAgICB2YXIgY3NzID0gJyc7CiAgICAgIHJ1bGVzLmZvckVhY2goZnVuY3Rpb24gKHJ1bGUpIHsKICAgICAgICBzd2l0Y2ggKHJ1bGUudHlwZSkgewogICAgICAgICAgY2FzZSBSdWxlVHlwZS5TVFlMRToKICAgICAgICAgICAgY3NzICs9IF90aGlzMi5ydWxlU3R5bGUocnVsZSwgcHJlZml4KTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBSdWxlVHlwZS5NRURJQToKICAgICAgICAgICAgY3NzICs9IF90aGlzMi5ydWxlTWVkaWEocnVsZSwgcHJlZml4KTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBSdWxlVHlwZS5TVVBQT1JUUzoKICAgICAgICAgICAgY3NzICs9IF90aGlzMi5ydWxlU3VwcG9ydChydWxlLCBwcmVmaXgpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBjc3MgKz0gIiIuY29uY2F0KHJ1bGUuY3NzVGV4dCk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJldHVybiBjc3M7CiAgICB9IC8vIGhhbmRsZSBjYXNlOgogICAgLy8gLmFwcC1tYWluIHt9CiAgICAvLyBodG1sLCBib2R5IHt9CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2xhc3MtbWV0aG9kcy11c2UtdGhpcwoKICB9LCB7CiAgICBrZXk6ICJydWxlU3R5bGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJ1bGVTdHlsZShydWxlLCBwcmVmaXgpIHsKICAgICAgdmFyIHJvb3RTZWxlY3RvclJFID0gLygoPzpbXlx3XC0uI118XikoYm9keXxodG1sfDpyb290KSkvZ207CiAgICAgIHZhciByb290Q29tYmluYXRpb25SRSA9IC8oaHRtbFteXHd7W10rKS9nbTsKICAgICAgdmFyIHNlbGVjdG9yID0gcnVsZS5zZWxlY3RvclRleHQudHJpbSgpOwogICAgICB2YXIgY3NzVGV4dCA9IHJ1bGUuY3NzVGV4dDsgLy8gaGFuZGxlIGh0bWwgeyAuLi4gfQogICAgICAvLyBoYW5kbGUgYm9keSB7IC4uLiB9CiAgICAgIC8vIGhhbmRsZSA6cm9vdCB7IC4uLiB9CgogICAgICBpZiAoc2VsZWN0b3IgPT09ICdodG1sJyB8fCBzZWxlY3RvciA9PT0gJ2JvZHknIHx8IHNlbGVjdG9yID09PSAnOnJvb3QnKSB7CiAgICAgICAgcmV0dXJuIGNzc1RleHQucmVwbGFjZShyb290U2VsZWN0b3JSRSwgcHJlZml4KTsKICAgICAgfSAvLyBoYW5kbGUgaHRtbCBib2R5IHsgLi4uIH0KICAgICAgLy8gaGFuZGxlIGh0bWwgPiBib2R5IHsgLi4uIH0KCgogICAgICBpZiAocm9vdENvbWJpbmF0aW9uUkUudGVzdChydWxlLnNlbGVjdG9yVGV4dCkpIHsKICAgICAgICB2YXIgc2libGluZ1NlbGVjdG9yUkUgPSAvKGh0bWxbXlx3e10rKShcK3x+KS9nbTsgLy8gc2luY2UgaHRtbCArIGJvZHkgaXMgYSBub24tc3RhbmRhcmQgcnVsZSBmb3IgaHRtbAogICAgICAgIC8vIHRyYW5zZm9ybWVyIHdpbGwgaWdub3JlIGl0CgogICAgICAgIGlmICghc2libGluZ1NlbGVjdG9yUkUudGVzdChydWxlLnNlbGVjdG9yVGV4dCkpIHsKICAgICAgICAgIGNzc1RleHQgPSBjc3NUZXh0LnJlcGxhY2Uocm9vdENvbWJpbmF0aW9uUkUsICcnKTsKICAgICAgICB9CiAgICAgIH0gLy8gaGFuZGxlIGdyb3VwaW5nIHNlbGVjdG9yLCBhLHNwYW4scCxkaXYgeyAuLi4gfQoKCiAgICAgIGNzc1RleHQgPSBjc3NUZXh0LnJlcGxhY2UoL15bXHNcU10rey8sIGZ1bmN0aW9uIChzZWxlY3RvcnMpIHsKICAgICAgICByZXR1cm4gc2VsZWN0b3JzLnJlcGxhY2UoLyhefCxcbj8pKFteLF0rKS9nLCBmdW5jdGlvbiAoaXRlbSwgcCwgcykgewogICAgICAgICAgLy8gaGFuZGxlIGRpdixib2R5LHNwYW4geyAuLi4gfQogICAgICAgICAgaWYgKHJvb3RTZWxlY3RvclJFLnRlc3QoaXRlbSkpIHsKICAgICAgICAgICAgcmV0dXJuIGl0ZW0ucmVwbGFjZShyb290U2VsZWN0b3JSRSwgZnVuY3Rpb24gKG0pIHsKICAgICAgICAgICAgICAvLyBkbyBub3QgZGlzY2FyZCB2YWxpZCBwcmV2aW91cyBjaGFyYWN0ZXIsIHN1Y2ggYXMgYm9keSxodG1sIG9yICo6bm90KDpyb290KQogICAgICAgICAgICAgIHZhciB3aGl0ZVByZXZDaGFycyA9IFsnLCcsICcoJ107CgogICAgICAgICAgICAgIGlmIChtICYmIHdoaXRlUHJldkNoYXJzLmluY2x1ZGVzKG1bMF0pKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gIiIuY29uY2F0KG1bMF0pLmNvbmNhdChwcmVmaXgpOwogICAgICAgICAgICAgIH0gLy8gcmVwbGFjZSByb290IHNlbGVjdG9yIHdpdGggcHJlZml4CgoKICAgICAgICAgICAgICByZXR1cm4gcHJlZml4OwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gIiIuY29uY2F0KHApLmNvbmNhdChwcmVmaXgsICIgIikuY29uY2F0KHMucmVwbGFjZSgvXiAqLywgJycpKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICAgIHJldHVybiBjc3NUZXh0OwogICAgfSAvLyBoYW5kbGUgY2FzZToKICAgIC8vIEBtZWRpYSBzY3JlZW4gYW5kIChtYXgtd2lkdGg6IDMwMHB4KSB7fQoKICB9LCB7CiAgICBrZXk6ICJydWxlTWVkaWEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJ1bGVNZWRpYShydWxlLCBwcmVmaXgpIHsKICAgICAgdmFyIGNzcyA9IHRoaXMucmV3cml0ZShhcnJheWlmeShydWxlLmNzc1J1bGVzKSwgcHJlZml4KTsKICAgICAgcmV0dXJuICJAbWVkaWEgIi5jb25jYXQocnVsZS5jb25kaXRpb25UZXh0LCAiIHsiKS5jb25jYXQoY3NzLCAifSIpOwogICAgfSAvLyBoYW5kbGUgY2FzZToKICAgIC8vIEBzdXBwb3J0cyAoZGlzcGxheTogZ3JpZCkge30KCiAgfSwgewogICAga2V5OiAicnVsZVN1cHBvcnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJ1bGVTdXBwb3J0KHJ1bGUsIHByZWZpeCkgewogICAgICB2YXIgY3NzID0gdGhpcy5yZXdyaXRlKGFycmF5aWZ5KHJ1bGUuY3NzUnVsZXMpLCBwcmVmaXgpOwogICAgICByZXR1cm4gIkBzdXBwb3J0cyAiLmNvbmNhdChydWxlLmNvbmRpdGlvblRleHQsICIgeyIpLmNvbmNhdChjc3MsICJ9Iik7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gU2NvcGVkQ1NTOwp9KCk7ClNjb3BlZENTUy5Nb2RpZmllZFRhZyA9ICdTeW1ib2woc3R5bGUtbW9kaWZpZWQtcWlhbmt1biknOwp2YXIgcHJvY2Vzc29yOwpleHBvcnQgdmFyIFFpYW5rdW5DU1NSZXdyaXRlQXR0ciA9ICdkYXRhLXFpYW5rdW4nOwpleHBvcnQgdmFyIHByb2Nlc3MgPSBmdW5jdGlvbiBwcm9jZXNzKGFwcFdyYXBwZXIsIHN0eWxlc2hlZXRFbGVtZW50LCBhcHBOYW1lKSB7CiAgLy8gbGF6eSBzaW5nbGV0b24gcGF0dGVybgogIGlmICghcHJvY2Vzc29yKSB7CiAgICBwcm9jZXNzb3IgPSBuZXcgU2NvcGVkQ1NTKCk7CiAgfQoKICBpZiAoc3R5bGVzaGVldEVsZW1lbnQudGFnTmFtZSA9PT0gJ0xJTksnKSB7CiAgICBjb25zb2xlLndhcm4oJ0ZlYXR1cmU6IHNhbmRib3guZXhwZXJpbWVudGFsU3R5bGVJc29sYXRpb24gaXMgbm90IHN1cHBvcnQgZm9yIGxpbmsgZWxlbWVudCB5ZXQuJyk7CiAgfQoKICB2YXIgbW91bnRET00gPSBhcHBXcmFwcGVyOwoKICBpZiAoIW1vdW50RE9NKSB7CiAgICByZXR1cm47CiAgfQoKICB2YXIgdGFnID0gKG1vdW50RE9NLnRhZ05hbWUgfHwgJycpLnRvTG93ZXJDYXNlKCk7CgogIGlmICh0YWcgJiYgc3R5bGVzaGVldEVsZW1lbnQudGFnTmFtZSA9PT0gJ1NUWUxFJykgewogICAgdmFyIHByZWZpeCA9ICIiLmNvbmNhdCh0YWcsICJbIikuY29uY2F0KFFpYW5rdW5DU1NSZXdyaXRlQXR0ciwgIj1cIiIpLmNvbmNhdChhcHBOYW1lLCAiXCJdIik7CiAgICBwcm9jZXNzb3IucHJvY2VzcyhzdHlsZXNoZWV0RWxlbWVudCwgcHJlZml4KTsKICB9Cn07"},{"version":3,"sources":["D:/qiankun微前台/Demo/qiankun/qiankun-base/node_modules/qiankun/es/sandbox/patchers/css.js"],"names":["_classCallCheck","_createClass","RuleType","arrayify","list","slice","call","rawDocumentBodyAppend","HTMLBodyElement","prototype","appendChild","ScopedCSS","styleNode","document","createElement","body","swapNode","sheet","disabled","key","value","process","_this","prefix","arguments","length","undefined","_a","textContent","textNode","createTextNode","rules","cssRules","css","rewrite","removeChild","mutator","MutationObserver","mutations","i","mutation","ModifiedTag","type","_sheet","_rules","_css","observe","childList","_this2","forEach","rule","STYLE","ruleStyle","MEDIA","ruleMedia","SUPPORTS","ruleSupport","concat","cssText","rootSelectorRE","rootCombinationRE","selector","selectorText","trim","replace","test","siblingSelectorRE","selectors","item","p","s","m","whitePrevChars","includes","conditionText","processor","QiankunCSSRewriteAttr","appWrapper","stylesheetElement","appName","tagName","console","warn","mountDOM","tag","toLowerCase"],"mappings":"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","sourcesContent":["import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\n\n/**\n * @author Saviio\n * @since 2020-4-19\n */\n// https://developer.mozilla.org/en-US/docs/Web/API/CSSRule\nvar RuleType;\n\n(function (RuleType) {\n  // type: rule will be rewrote\n  RuleType[RuleType[\"STYLE\"] = 1] = \"STYLE\";\n  RuleType[RuleType[\"MEDIA\"] = 4] = \"MEDIA\";\n  RuleType[RuleType[\"SUPPORTS\"] = 12] = \"SUPPORTS\"; // type: value will be kept\n\n  RuleType[RuleType[\"IMPORT\"] = 3] = \"IMPORT\";\n  RuleType[RuleType[\"FONT_FACE\"] = 5] = \"FONT_FACE\";\n  RuleType[RuleType[\"PAGE\"] = 6] = \"PAGE\";\n  RuleType[RuleType[\"KEYFRAMES\"] = 7] = \"KEYFRAMES\";\n  RuleType[RuleType[\"KEYFRAME\"] = 8] = \"KEYFRAME\";\n})(RuleType || (RuleType = {}));\n\nvar arrayify = function arrayify(list) {\n  return [].slice.call(list, 0);\n};\n\nvar rawDocumentBodyAppend = HTMLBodyElement.prototype.appendChild;\nexport var ScopedCSS = /*#__PURE__*/function () {\n  function ScopedCSS() {\n    _classCallCheck(this, ScopedCSS);\n\n    var styleNode = document.createElement('style');\n    rawDocumentBodyAppend.call(document.body, styleNode);\n    this.swapNode = styleNode;\n    this.sheet = styleNode.sheet;\n    this.sheet.disabled = true;\n  }\n\n  _createClass(ScopedCSS, [{\n    key: \"process\",\n    value: function process(styleNode) {\n      var _this = this;\n\n      var prefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n\n      var _a;\n\n      if (styleNode.textContent !== '') {\n        var textNode = document.createTextNode(styleNode.textContent || '');\n        this.swapNode.appendChild(textNode);\n        var sheet = this.swapNode.sheet; // type is missing\n\n        var rules = arrayify((_a = sheet === null || sheet === void 0 ? void 0 : sheet.cssRules) !== null && _a !== void 0 ? _a : []);\n        var css = this.rewrite(rules, prefix); // eslint-disable-next-line no-param-reassign\n\n        styleNode.textContent = css; // cleanup\n\n        this.swapNode.removeChild(textNode);\n        return;\n      }\n\n      var mutator = new MutationObserver(function (mutations) {\n        var _a;\n\n        for (var i = 0; i < mutations.length; i += 1) {\n          var mutation = mutations[i];\n\n          if (ScopedCSS.ModifiedTag in styleNode) {\n            return;\n          }\n\n          if (mutation.type === 'childList') {\n            var _sheet = styleNode.sheet;\n\n            var _rules = arrayify((_a = _sheet === null || _sheet === void 0 ? void 0 : _sheet.cssRules) !== null && _a !== void 0 ? _a : []);\n\n            var _css = _this.rewrite(_rules, prefix); // eslint-disable-next-line no-param-reassign\n\n\n            styleNode.textContent = _css; // eslint-disable-next-line no-param-reassign\n\n            styleNode[ScopedCSS.ModifiedTag] = true;\n          }\n        }\n      }); // since observer will be deleted when node be removed\n      // we dont need create a cleanup function manually\n      // see https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver/disconnect\n\n      mutator.observe(styleNode, {\n        childList: true\n      });\n    }\n  }, {\n    key: \"rewrite\",\n    value: function rewrite(rules) {\n      var _this2 = this;\n\n      var prefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n      var css = '';\n      rules.forEach(function (rule) {\n        switch (rule.type) {\n          case RuleType.STYLE:\n            css += _this2.ruleStyle(rule, prefix);\n            break;\n\n          case RuleType.MEDIA:\n            css += _this2.ruleMedia(rule, prefix);\n            break;\n\n          case RuleType.SUPPORTS:\n            css += _this2.ruleSupport(rule, prefix);\n            break;\n\n          default:\n            css += \"\".concat(rule.cssText);\n            break;\n        }\n      });\n      return css;\n    } // handle case:\n    // .app-main {}\n    // html, body {}\n    // eslint-disable-next-line class-methods-use-this\n\n  }, {\n    key: \"ruleStyle\",\n    value: function ruleStyle(rule, prefix) {\n      var rootSelectorRE = /((?:[^\\w\\-.#]|^)(body|html|:root))/gm;\n      var rootCombinationRE = /(html[^\\w{[]+)/gm;\n      var selector = rule.selectorText.trim();\n      var cssText = rule.cssText; // handle html { ... }\n      // handle body { ... }\n      // handle :root { ... }\n\n      if (selector === 'html' || selector === 'body' || selector === ':root') {\n        return cssText.replace(rootSelectorRE, prefix);\n      } // handle html body { ... }\n      // handle html > body { ... }\n\n\n      if (rootCombinationRE.test(rule.selectorText)) {\n        var siblingSelectorRE = /(html[^\\w{]+)(\\+|~)/gm; // since html + body is a non-standard rule for html\n        // transformer will ignore it\n\n        if (!siblingSelectorRE.test(rule.selectorText)) {\n          cssText = cssText.replace(rootCombinationRE, '');\n        }\n      } // handle grouping selector, a,span,p,div { ... }\n\n\n      cssText = cssText.replace(/^[\\s\\S]+{/, function (selectors) {\n        return selectors.replace(/(^|,\\n?)([^,]+)/g, function (item, p, s) {\n          // handle div,body,span { ... }\n          if (rootSelectorRE.test(item)) {\n            return item.replace(rootSelectorRE, function (m) {\n              // do not discard valid previous character, such as body,html or *:not(:root)\n              var whitePrevChars = [',', '('];\n\n              if (m && whitePrevChars.includes(m[0])) {\n                return \"\".concat(m[0]).concat(prefix);\n              } // replace root selector with prefix\n\n\n              return prefix;\n            });\n          }\n\n          return \"\".concat(p).concat(prefix, \" \").concat(s.replace(/^ */, ''));\n        });\n      });\n      return cssText;\n    } // handle case:\n    // @media screen and (max-width: 300px) {}\n\n  }, {\n    key: \"ruleMedia\",\n    value: function ruleMedia(rule, prefix) {\n      var css = this.rewrite(arrayify(rule.cssRules), prefix);\n      return \"@media \".concat(rule.conditionText, \" {\").concat(css, \"}\");\n    } // handle case:\n    // @supports (display: grid) {}\n\n  }, {\n    key: \"ruleSupport\",\n    value: function ruleSupport(rule, prefix) {\n      var css = this.rewrite(arrayify(rule.cssRules), prefix);\n      return \"@supports \".concat(rule.conditionText, \" {\").concat(css, \"}\");\n    }\n  }]);\n\n  return ScopedCSS;\n}();\nScopedCSS.ModifiedTag = 'Symbol(style-modified-qiankun)';\nvar processor;\nexport var QiankunCSSRewriteAttr = 'data-qiankun';\nexport var process = function process(appWrapper, stylesheetElement, appName) {\n  // lazy singleton pattern\n  if (!processor) {\n    processor = new ScopedCSS();\n  }\n\n  if (stylesheetElement.tagName === 'LINK') {\n    console.warn('Feature: sandbox.experimentalStyleIsolation is not support for link element yet.');\n  }\n\n  var mountDOM = appWrapper;\n\n  if (!mountDOM) {\n    return;\n  }\n\n  var tag = (mountDOM.tagName || '').toLowerCase();\n\n  if (tag && stylesheetElement.tagName === 'STYLE') {\n    var prefix = \"\".concat(tag, \"[\").concat(QiankunCSSRewriteAttr, \"=\\\"\").concat(appName, \"\\\"]\");\n    processor.process(stylesheetElement, prefix);\n  }\n};"]}]}