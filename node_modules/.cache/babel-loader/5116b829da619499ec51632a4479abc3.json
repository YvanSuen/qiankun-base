{"remainingRequest":"D:\\qiankun微前台\\Demo\\qiankun\\qiankun-base\\node_modules\\babel-loader\\lib\\index.js!D:\\qiankun微前台\\Demo\\qiankun\\qiankun-base\\node_modules\\qiankun\\es\\sandbox\\patchers\\dynamicAppend\\common.js","dependencies":[{"path":"D:\\qiankun微前台\\Demo\\qiankun\\qiankun-base\\node_modules\\qiankun\\es\\sandbox\\patchers\\dynamicAppend\\common.js","mtime":1631881155000},{"path":"D:\\qiankun微前台\\Demo\\qiankun\\qiankun-base\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1618900774989},{"path":"D:\\qiankun微前台\\Demo\\qiankun\\qiankun-base\\node_modules\\babel-loader\\lib\\index.js","mtime":1618886346176}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLndlYWstbWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yLmpzIjsKaW1wb3J0IF9pc0Z1bmN0aW9uIGZyb20gImxvZGFzaC9pc0Z1bmN0aW9uIjsKLyoqCiAqIEBhdXRob3IgS3VpdG9zCiAqIEBzaW5jZSAyMDE5LTEwLTIxCiAqLwoKaW1wb3J0IHsgZXhlY1NjcmlwdHMgfSBmcm9tICdpbXBvcnQtaHRtbC1lbnRyeSc7CmltcG9ydCB7IGZyYW1ld29ya0NvbmZpZ3VyYXRpb24gfSBmcm9tICcuLi8uLi8uLi9hcGlzJzsKaW1wb3J0ICogYXMgY3NzIGZyb20gJy4uL2Nzcyc7CmV4cG9ydCB2YXIgcmF3SGVhZEFwcGVuZENoaWxkID0gSFRNTEhlYWRFbGVtZW50LnByb3RvdHlwZS5hcHBlbmRDaGlsZDsKdmFyIHJhd0hlYWRSZW1vdmVDaGlsZCA9IEhUTUxIZWFkRWxlbWVudC5wcm90b3R5cGUucmVtb3ZlQ2hpbGQ7CnZhciByYXdCb2R5QXBwZW5kQ2hpbGQgPSBIVE1MQm9keUVsZW1lbnQucHJvdG90eXBlLmFwcGVuZENoaWxkOwp2YXIgcmF3Qm9keVJlbW92ZUNoaWxkID0gSFRNTEJvZHlFbGVtZW50LnByb3RvdHlwZS5yZW1vdmVDaGlsZDsKdmFyIHJhd0hlYWRJbnNlcnRCZWZvcmUgPSBIVE1MSGVhZEVsZW1lbnQucHJvdG90eXBlLmluc2VydEJlZm9yZTsKdmFyIHJhd1JlbW92ZUNoaWxkID0gSFRNTEVsZW1lbnQucHJvdG90eXBlLnJlbW92ZUNoaWxkOwp2YXIgU0NSSVBUX1RBR19OQU1FID0gJ1NDUklQVCc7CnZhciBMSU5LX1RBR19OQU1FID0gJ0xJTksnOwp2YXIgU1RZTEVfVEFHX05BTUUgPSAnU1RZTEUnOwpleHBvcnQgZnVuY3Rpb24gaXNIaWphY2tpbmdUYWcodGFnTmFtZSkgewogIHJldHVybiAodGFnTmFtZSA9PT0gbnVsbCB8fCB0YWdOYW1lID09PSB2b2lkIDAgPyB2b2lkIDAgOiB0YWdOYW1lLnRvVXBwZXJDYXNlKCkpID09PSBMSU5LX1RBR19OQU1FIHx8ICh0YWdOYW1lID09PSBudWxsIHx8IHRhZ05hbWUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHRhZ05hbWUudG9VcHBlckNhc2UoKSkgPT09IFNUWUxFX1RBR19OQU1FIHx8ICh0YWdOYW1lID09PSBudWxsIHx8IHRhZ05hbWUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHRhZ05hbWUudG9VcHBlckNhc2UoKSkgPT09IFNDUklQVF9UQUdfTkFNRTsKfQovKioKICogQ2hlY2sgaWYgYSBzdHlsZSBlbGVtZW50IGlzIGEgc3R5bGVkLWNvbXBvbmVudCBsaWtlZC4KICogQSBzdHlsZWQtY29tcG9uZW50cyBsaWtlZCBlbGVtZW50IGlzIHdoaWNoIG5vdCBoYXZlIHRleHRDb250ZXh0IGJ1dCBrZWVwIHRoZSBydWxlcyBpbiBpdHMgc3R5bGVTaGVldC5jc3NSdWxlcy4KICogU3VjaCBhcyB0aGUgc3R5bGUgZWxlbWVudCBnZW5lcmF0ZWQgYnkgc3R5bGVkLWNvbXBvbmVudHMgYW5kIGVtb3Rpb24uCiAqIEBwYXJhbSBlbGVtZW50CiAqLwoKZXhwb3J0IGZ1bmN0aW9uIGlzU3R5bGVkQ29tcG9uZW50c0xpa2UoZWxlbWVudCkgewogIHZhciBfYSwgX2I7CgogIHJldHVybiAhZWxlbWVudC50ZXh0Q29udGVudCAmJiAoKChfYSA9IGVsZW1lbnQuc2hlZXQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5jc3NSdWxlcy5sZW5ndGgpIHx8ICgoX2IgPSBnZXRTdHlsZWRFbGVtZW50Q1NTUnVsZXMoZWxlbWVudCkpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5sZW5ndGgpKTsKfQoKZnVuY3Rpb24gcGF0Y2hDdXN0b21FdmVudChlLCBlbGVtZW50R2V0dGVyKSB7CiAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSwgewogICAgc3JjRWxlbWVudDogewogICAgICBnZXQ6IGVsZW1lbnRHZXR0ZXIKICAgIH0sCiAgICB0YXJnZXQ6IHsKICAgICAgZ2V0OiBlbGVtZW50R2V0dGVyCiAgICB9CiAgfSk7CiAgcmV0dXJuIGU7Cn0KCmZ1bmN0aW9uIG1hbnVhbEludm9rZUVsZW1lbnRPbkxvYWQoZWxlbWVudCkgewogIC8vIHdlIG5lZWQgdG8gaW52b2tlIHRoZSBvbmxvYWQgZXZlbnQgbWFudWFsbHkgdG8gbm90aWZ5IHRoZSBldmVudCBsaXN0ZW5lciB0aGF0IHRoZSBzY3JpcHQgd2FzIGNvbXBsZXRlZAogIC8vIGhlcmUgYXJlIHRoZSB0d28gdHlwaWNhbCB3YXlzIG9mIGR5bmFtaWMgc2NyaXB0IGxvYWRpbmcKICAvLyAxLiBlbGVtZW50Lm9ubG9hZCBjYWxsYmFjayB3YXksIHdoaWNoIHdlYnBhY2sgYW5kIGxvYWRqcyB1c2VkLCBzZWUgaHR0cHM6Ly9naXRodWIuY29tL211aWNzcy9sb2FkanMvYmxvYi9tYXN0ZXIvc3JjL2xvYWRqcy5qcyNMMTM4CiAgLy8gMi4gYWRkRXZlbnRMaXN0ZW5lciB3YXksIHdoaWNoIHRvYXN0LWxvYWRlciB1c2VkLCBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3B5cnNtay90b2FzdC9ibG9iL21hc3Rlci9zcmMvVG9hc3QudHMjTDY0CiAgdmFyIGxvYWRFdmVudCA9IG5ldyBDdXN0b21FdmVudCgnbG9hZCcpOwogIHZhciBwYXRjaGVkRXZlbnQgPSBwYXRjaEN1c3RvbUV2ZW50KGxvYWRFdmVudCwgZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIGVsZW1lbnQ7CiAgfSk7CgogIGlmIChfaXNGdW5jdGlvbihlbGVtZW50Lm9ubG9hZCkpIHsKICAgIGVsZW1lbnQub25sb2FkKHBhdGNoZWRFdmVudCk7CiAgfSBlbHNlIHsKICAgIGVsZW1lbnQuZGlzcGF0Y2hFdmVudChwYXRjaGVkRXZlbnQpOwogIH0KfQoKZnVuY3Rpb24gbWFudWFsSW52b2tlRWxlbWVudE9uRXJyb3IoZWxlbWVudCkgewogIHZhciBlcnJvckV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdlcnJvcicpOwogIHZhciBwYXRjaGVkRXZlbnQgPSBwYXRjaEN1c3RvbUV2ZW50KGVycm9yRXZlbnQsIGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiBlbGVtZW50OwogIH0pOwoKICBpZiAoX2lzRnVuY3Rpb24oZWxlbWVudC5vbmVycm9yKSkgewogICAgZWxlbWVudC5vbmVycm9yKHBhdGNoZWRFdmVudCk7CiAgfSBlbHNlIHsKICAgIGVsZW1lbnQuZGlzcGF0Y2hFdmVudChwYXRjaGVkRXZlbnQpOwogIH0KfQoKZnVuY3Rpb24gY29udmVydExpbmtBc1N0eWxlKGVsZW1lbnQsIHBvc3RQcm9jZXNzKSB7CiAgdmFyIGZldGNoRm4gPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IGZldGNoOwogIHZhciBzdHlsZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpOwogIHZhciBocmVmID0gZWxlbWVudC5ocmVmOyAvLyBhZGQgc291cmNlIGxpbmsgZWxlbWVudCBocmVmCgogIHN0eWxlRWxlbWVudC5kYXRhc2V0LnFpYW5rdW5IcmVmID0gaHJlZjsKICBmZXRjaEZuKGhyZWYpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgcmV0dXJuIHJlcy50ZXh0KCk7CiAgfSkudGhlbihmdW5jdGlvbiAoc3R5bGVDb250ZXh0KSB7CiAgICBzdHlsZUVsZW1lbnQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoc3R5bGVDb250ZXh0KSk7CiAgICBwb3N0UHJvY2VzcyhzdHlsZUVsZW1lbnQpOwogICAgbWFudWFsSW52b2tlRWxlbWVudE9uTG9hZChlbGVtZW50KTsKICB9KS5jYXRjaChmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gbWFudWFsSW52b2tlRWxlbWVudE9uRXJyb3IoZWxlbWVudCk7CiAgfSk7CiAgcmV0dXJuIHN0eWxlRWxlbWVudDsKfQoKdmFyIHN0eWxlZENvbXBvbmVudENTU1J1bGVzTWFwID0gbmV3IFdlYWtNYXAoKTsKdmFyIGR5bmFtaWNTY3JpcHRBdHRhY2hlZENvbW1lbnRNYXAgPSBuZXcgV2Vha01hcCgpOwp2YXIgZHluYW1pY0xpbmtBdHRhY2hlZElubGluZVN0eWxlTWFwID0gbmV3IFdlYWtNYXAoKTsKZXhwb3J0IGZ1bmN0aW9uIHJlY29yZFN0eWxlZENvbXBvbmVudHNDU1NSdWxlcyhzdHlsZUVsZW1lbnRzKSB7CiAgc3R5bGVFbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChzdHlsZUVsZW1lbnQpIHsKICAgIC8qCiAgICAgV2l0aCBhIHN0eWxlZC1jb21wb25lbnRzIGdlbmVyYXRlZCBzdHlsZSBlbGVtZW50LCB3ZSBuZWVkIHRvIHJlY29yZCBpdHMgY3NzUnVsZXMgZm9yIHJlc3RvcmUgbmV4dCByZS1tb3VudGluZyB0aW1lLgogICAgIFdlJ3JlIGRvaW5nIHRoaXMgYmVjYXVzZSB0aGUgc2hlZXQgb2Ygc3R5bGUgZWxlbWVudCBpcyBnb2luZyB0byBiZSBjbGVhbmVkIGF1dG9tYXRpY2FsbHkgYnkgYnJvd3NlciBhZnRlciB0aGUgc3R5bGUgZWxlbWVudCBkb20gcmVtb3ZlZCBmcm9tIGRvY3VtZW50LgogICAgIHNlZSBodHRwczovL3d3dy53My5vcmcvVFIvY3Nzb20tMS8jYXNzb2NpYXRlZC1jc3Mtc3R5bGUtc2hlZXQKICAgICAqLwogICAgaWYgKHN0eWxlRWxlbWVudCBpbnN0YW5jZW9mIEhUTUxTdHlsZUVsZW1lbnQgJiYgaXNTdHlsZWRDb21wb25lbnRzTGlrZShzdHlsZUVsZW1lbnQpKSB7CiAgICAgIGlmIChzdHlsZUVsZW1lbnQuc2hlZXQpIHsKICAgICAgICAvLyByZWNvcmQgdGhlIG9yaWdpbmFsIGNzcyBydWxlcyBvZiB0aGUgc3R5bGUgZWxlbWVudCBmb3IgcmVzdG9yZQogICAgICAgIHN0eWxlZENvbXBvbmVudENTU1J1bGVzTWFwLnNldChzdHlsZUVsZW1lbnQsIHN0eWxlRWxlbWVudC5zaGVldC5jc3NSdWxlcyk7CiAgICAgIH0KICAgIH0KICB9KTsKfQpleHBvcnQgZnVuY3Rpb24gZ2V0U3R5bGVkRWxlbWVudENTU1J1bGVzKHN0eWxlZEVsZW1lbnQpIHsKICByZXR1cm4gc3R5bGVkQ29tcG9uZW50Q1NTUnVsZXNNYXAuZ2V0KHN0eWxlZEVsZW1lbnQpOwp9CgpmdW5jdGlvbiBnZXRPdmVyd3JpdHRlbkFwcGVuZENoaWxkT3JJbnNlcnRCZWZvcmUob3B0cykgewogIHJldHVybiBmdW5jdGlvbiBhcHBlbmRDaGlsZE9ySW5zZXJ0QmVmb3JlKG5ld0NoaWxkLCByZWZDaGlsZCkgewogICAgdmFyIF9hLCBfYjsKCiAgICB2YXIgZWxlbWVudCA9IG5ld0NoaWxkOwogICAgdmFyIHJhd0RPTUFwcGVuZE9ySW5zZXJ0QmVmb3JlID0gb3B0cy5yYXdET01BcHBlbmRPckluc2VydEJlZm9yZSwKICAgICAgICBpc0ludm9rZWRCeU1pY3JvQXBwID0gb3B0cy5pc0ludm9rZWRCeU1pY3JvQXBwLAogICAgICAgIGNvbnRhaW5lckNvbmZpZ0dldHRlciA9IG9wdHMuY29udGFpbmVyQ29uZmlnR2V0dGVyOwoKICAgIGlmICghaXNIaWphY2tpbmdUYWcoZWxlbWVudC50YWdOYW1lKSB8fCAhaXNJbnZva2VkQnlNaWNyb0FwcChlbGVtZW50KSkgewogICAgICByZXR1cm4gcmF3RE9NQXBwZW5kT3JJbnNlcnRCZWZvcmUuY2FsbCh0aGlzLCBlbGVtZW50LCByZWZDaGlsZCk7CiAgICB9CgogICAgaWYgKGVsZW1lbnQudGFnTmFtZSkgewogICAgICB2YXIgY29udGFpbmVyQ29uZmlnID0gY29udGFpbmVyQ29uZmlnR2V0dGVyKGVsZW1lbnQpOwogICAgICB2YXIgYXBwTmFtZSA9IGNvbnRhaW5lckNvbmZpZy5hcHBOYW1lLAogICAgICAgICAgYXBwV3JhcHBlckdldHRlciA9IGNvbnRhaW5lckNvbmZpZy5hcHBXcmFwcGVyR2V0dGVyLAogICAgICAgICAgcHJveHkgPSBjb250YWluZXJDb25maWcucHJveHksCiAgICAgICAgICBzdHJpY3RHbG9iYWwgPSBjb250YWluZXJDb25maWcuc3RyaWN0R2xvYmFsLAogICAgICAgICAgZHluYW1pY1N0eWxlU2hlZXRFbGVtZW50cyA9IGNvbnRhaW5lckNvbmZpZy5keW5hbWljU3R5bGVTaGVldEVsZW1lbnRzLAogICAgICAgICAgc2NvcGVkQ1NTID0gY29udGFpbmVyQ29uZmlnLnNjb3BlZENTUywKICAgICAgICAgIGV4Y2x1ZGVBc3NldEZpbHRlciA9IGNvbnRhaW5lckNvbmZpZy5leGNsdWRlQXNzZXRGaWx0ZXI7CgogICAgICBzd2l0Y2ggKGVsZW1lbnQudGFnTmFtZSkgewogICAgICAgIGNhc2UgTElOS19UQUdfTkFNRToKICAgICAgICBjYXNlIFNUWUxFX1RBR19OQU1FOgogICAgICAgICAgewogICAgICAgICAgICB2YXIgc3R5bGVzaGVldEVsZW1lbnQgPSBuZXdDaGlsZDsKICAgICAgICAgICAgdmFyIF9zdHlsZXNoZWV0RWxlbWVudCA9IHN0eWxlc2hlZXRFbGVtZW50LAogICAgICAgICAgICAgICAgaHJlZiA9IF9zdHlsZXNoZWV0RWxlbWVudC5ocmVmOwoKICAgICAgICAgICAgaWYgKGV4Y2x1ZGVBc3NldEZpbHRlciAmJiBocmVmICYmIGV4Y2x1ZGVBc3NldEZpbHRlcihocmVmKSkgewogICAgICAgICAgICAgIHJldHVybiByYXdET01BcHBlbmRPckluc2VydEJlZm9yZS5jYWxsKHRoaXMsIGVsZW1lbnQsIHJlZkNoaWxkKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIG1vdW50RE9NID0gYXBwV3JhcHBlckdldHRlcigpOwoKICAgICAgICAgICAgaWYgKHNjb3BlZENTUykgewogICAgICAgICAgICAgIC8vIGV4Y2x1ZGUgbGluayBlbGVtZW50cyBsaWtlIDxsaW5rIHJlbD0iaWNvbiIgaHJlZj0iZmF2aWNvbi5pY28iPgogICAgICAgICAgICAgIHZhciBsaW5rRWxlbWVudFVzaW5nU3R5bGVzaGVldCA9ICgoX2EgPSBlbGVtZW50LnRhZ05hbWUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS50b1VwcGVyQ2FzZSgpKSA9PT0gTElOS19UQUdfTkFNRSAmJiBlbGVtZW50LnJlbCA9PT0gJ3N0eWxlc2hlZXQnICYmIGVsZW1lbnQuaHJlZjsKCiAgICAgICAgICAgICAgaWYgKGxpbmtFbGVtZW50VXNpbmdTdHlsZXNoZWV0KSB7CiAgICAgICAgICAgICAgICB2YXIgX2ZldGNoID0gdHlwZW9mIGZyYW1ld29ya0NvbmZpZ3VyYXRpb24uZmV0Y2ggPT09ICdmdW5jdGlvbicgPyBmcmFtZXdvcmtDb25maWd1cmF0aW9uLmZldGNoIDogKF9iID0gZnJhbWV3b3JrQ29uZmlndXJhdGlvbi5mZXRjaCkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmZuOwoKICAgICAgICAgICAgICAgIHN0eWxlc2hlZXRFbGVtZW50ID0gY29udmVydExpbmtBc1N0eWxlKGVsZW1lbnQsIGZ1bmN0aW9uIChzdHlsZUVsZW1lbnQpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGNzcy5wcm9jZXNzKG1vdW50RE9NLCBzdHlsZUVsZW1lbnQsIGFwcE5hbWUpOwogICAgICAgICAgICAgICAgfSwgX2ZldGNoKTsKICAgICAgICAgICAgICAgIGR5bmFtaWNMaW5rQXR0YWNoZWRJbmxpbmVTdHlsZU1hcC5zZXQoZWxlbWVudCwgc3R5bGVzaGVldEVsZW1lbnQpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjc3MucHJvY2Vzcyhtb3VudERPTSwgc3R5bGVzaGVldEVsZW1lbnQsIGFwcE5hbWUpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tc2hhZG93CgoKICAgICAgICAgICAgZHluYW1pY1N0eWxlU2hlZXRFbGVtZW50cy5wdXNoKHN0eWxlc2hlZXRFbGVtZW50KTsKICAgICAgICAgICAgdmFyIHJlZmVyZW5jZU5vZGUgPSBtb3VudERPTS5jb250YWlucyhyZWZDaGlsZCkgPyByZWZDaGlsZCA6IG51bGw7CiAgICAgICAgICAgIHJldHVybiByYXdET01BcHBlbmRPckluc2VydEJlZm9yZS5jYWxsKG1vdW50RE9NLCBzdHlsZXNoZWV0RWxlbWVudCwgcmVmZXJlbmNlTm9kZSk7CiAgICAgICAgICB9CgogICAgICAgIGNhc2UgU0NSSVBUX1RBR19OQU1FOgogICAgICAgICAgewogICAgICAgICAgICB2YXIgX2VsZW1lbnQgPSBlbGVtZW50LAogICAgICAgICAgICAgICAgc3JjID0gX2VsZW1lbnQuc3JjLAogICAgICAgICAgICAgICAgdGV4dCA9IF9lbGVtZW50LnRleHQ7IC8vIHNvbWUgc2NyaXB0IGxpa2UganNvbnAgbWF5YmUgbm90IHN1cHBvcnQgY29ycyB3aGljaCBzaG91bGQndCB1c2UgZXhlY1NjcmlwdHMKCiAgICAgICAgICAgIGlmIChleGNsdWRlQXNzZXRGaWx0ZXIgJiYgc3JjICYmIGV4Y2x1ZGVBc3NldEZpbHRlcihzcmMpKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHJhd0RPTUFwcGVuZE9ySW5zZXJ0QmVmb3JlLmNhbGwodGhpcywgZWxlbWVudCwgcmVmQ2hpbGQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgX21vdW50RE9NID0gYXBwV3JhcHBlckdldHRlcigpOwoKICAgICAgICAgICAgdmFyIF9mZXRjaDIgPSBmcmFtZXdvcmtDb25maWd1cmF0aW9uLmZldGNoOwoKICAgICAgICAgICAgdmFyIF9yZWZlcmVuY2VOb2RlID0gX21vdW50RE9NLmNvbnRhaW5zKHJlZkNoaWxkKSA/IHJlZkNoaWxkIDogbnVsbDsKCiAgICAgICAgICAgIGlmIChzcmMpIHsKICAgICAgICAgICAgICBleGVjU2NyaXB0cyhudWxsLCBbc3JjXSwgcHJveHksIHsKICAgICAgICAgICAgICAgIGZldGNoOiBfZmV0Y2gyLAogICAgICAgICAgICAgICAgc3RyaWN0R2xvYmFsOiBzdHJpY3RHbG9iYWwsCiAgICAgICAgICAgICAgICBiZWZvcmVFeGVjOiBmdW5jdGlvbiBiZWZvcmVFeGVjKCkgewogICAgICAgICAgICAgICAgICB2YXIgaXNDdXJyZW50U2NyaXB0Q29uZmlndXJhYmxlID0gZnVuY3Rpb24gaXNDdXJyZW50U2NyaXB0Q29uZmlndXJhYmxlKCkgewogICAgICAgICAgICAgICAgICAgIHZhciBkZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihkb2N1bWVudCwgJ2N1cnJlbnRTY3JpcHQnKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gIWRlc2NyaXB0b3IgfHwgZGVzY3JpcHRvci5jb25maWd1cmFibGU7CiAgICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgICBpZiAoaXNDdXJyZW50U2NyaXB0Q29uZmlndXJhYmxlKCkpIHsKICAgICAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZG9jdW1lbnQsICdjdXJyZW50U2NyaXB0JywgewogICAgICAgICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50OwogICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gc3VjY2VzcygpIHsKICAgICAgICAgICAgICAgICAgbWFudWFsSW52b2tlRWxlbWVudE9uTG9hZChlbGVtZW50KTsKICAgICAgICAgICAgICAgICAgZWxlbWVudCA9IG51bGw7CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIGVycm9yKCkgewogICAgICAgICAgICAgICAgICBtYW51YWxJbnZva2VFbGVtZW50T25FcnJvcihlbGVtZW50KTsKICAgICAgICAgICAgICAgICAgZWxlbWVudCA9IG51bGw7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgdmFyIGR5bmFtaWNTY3JpcHRDb21tZW50RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUNvbW1lbnQoImR5bmFtaWMgc2NyaXB0ICIuY29uY2F0KHNyYywgIiByZXBsYWNlZCBieSBxaWFua3VuIikpOwogICAgICAgICAgICAgIGR5bmFtaWNTY3JpcHRBdHRhY2hlZENvbW1lbnRNYXAuc2V0KGVsZW1lbnQsIGR5bmFtaWNTY3JpcHRDb21tZW50RWxlbWVudCk7CiAgICAgICAgICAgICAgcmV0dXJuIHJhd0RPTUFwcGVuZE9ySW5zZXJ0QmVmb3JlLmNhbGwoX21vdW50RE9NLCBkeW5hbWljU2NyaXB0Q29tbWVudEVsZW1lbnQsIF9yZWZlcmVuY2VOb2RlKTsKICAgICAgICAgICAgfSAvLyBpbmxpbmUgc2NyaXB0IG5ldmVyIHRyaWdnZXIgdGhlIG9ubG9hZCBhbmQgb25lcnJvciBldmVudAoKCiAgICAgICAgICAgIGV4ZWNTY3JpcHRzKG51bGwsIFsiPHNjcmlwdD4iLmNvbmNhdCh0ZXh0LCAiPC9zY3JpcHQ+IildLCBwcm94eSwgewogICAgICAgICAgICAgIHN0cmljdEdsb2JhbDogc3RyaWN0R2xvYmFsCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB2YXIgZHluYW1pY0lubGluZVNjcmlwdENvbW1lbnRFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlQ29tbWVudCgnZHluYW1pYyBpbmxpbmUgc2NyaXB0IHJlcGxhY2VkIGJ5IHFpYW5rdW4nKTsKICAgICAgICAgICAgZHluYW1pY1NjcmlwdEF0dGFjaGVkQ29tbWVudE1hcC5zZXQoZWxlbWVudCwgZHluYW1pY0lubGluZVNjcmlwdENvbW1lbnRFbGVtZW50KTsKICAgICAgICAgICAgcmV0dXJuIHJhd0RPTUFwcGVuZE9ySW5zZXJ0QmVmb3JlLmNhbGwoX21vdW50RE9NLCBkeW5hbWljSW5saW5lU2NyaXB0Q29tbWVudEVsZW1lbnQsIF9yZWZlcmVuY2VOb2RlKTsKICAgICAgICAgIH0KCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHJhd0RPTUFwcGVuZE9ySW5zZXJ0QmVmb3JlLmNhbGwodGhpcywgZWxlbWVudCwgcmVmQ2hpbGQpOwogIH07Cn0KCmZ1bmN0aW9uIGdldE5ld1JlbW92ZUNoaWxkKGhlYWRPckJvZHlSZW1vdmVDaGlsZCwgYXBwV3JhcHBlckdldHRlckdldHRlcikgewogIHJldHVybiBmdW5jdGlvbiByZW1vdmVDaGlsZChjaGlsZCkgewogICAgdmFyIHRhZ05hbWUgPSBjaGlsZC50YWdOYW1lOwogICAgaWYgKCFpc0hpamFja2luZ1RhZyh0YWdOYW1lKSkgcmV0dXJuIGhlYWRPckJvZHlSZW1vdmVDaGlsZC5jYWxsKHRoaXMsIGNoaWxkKTsKCiAgICB0cnkgewogICAgICB2YXIgYXR0YWNoZWRFbGVtZW50OwoKICAgICAgc3dpdGNoICh0YWdOYW1lKSB7CiAgICAgICAgY2FzZSBMSU5LX1RBR19OQU1FOgogICAgICAgICAgewogICAgICAgICAgICBhdHRhY2hlZEVsZW1lbnQgPSBkeW5hbWljTGlua0F0dGFjaGVkSW5saW5lU3R5bGVNYXAuZ2V0KGNoaWxkKSB8fCBjaGlsZDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgIGNhc2UgU0NSSVBUX1RBR19OQU1FOgogICAgICAgICAgewogICAgICAgICAgICBhdHRhY2hlZEVsZW1lbnQgPSBkeW5hbWljU2NyaXB0QXR0YWNoZWRDb21tZW50TWFwLmdldChjaGlsZCkgfHwgY2hpbGQ7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgewogICAgICAgICAgICBhdHRhY2hlZEVsZW1lbnQgPSBjaGlsZDsKICAgICAgICAgIH0KICAgICAgfSAvLyBjb250YWluZXIgbWF5IGhhZCBiZWVuIHJlbW92ZWQgd2hpbGUgYXBwIHVubW91bnRpbmcgaWYgdGhlIHJlbW92ZUNoaWxkIGFjdGlvbiB3YXMgYXN5bmMKCgogICAgICB2YXIgYXBwV3JhcHBlckdldHRlciA9IGFwcFdyYXBwZXJHZXR0ZXJHZXR0ZXIoY2hpbGQpOwogICAgICB2YXIgY29udGFpbmVyID0gYXBwV3JhcHBlckdldHRlcigpOwoKICAgICAgaWYgKGNvbnRhaW5lci5jb250YWlucyhhdHRhY2hlZEVsZW1lbnQpKSB7CiAgICAgICAgcmV0dXJuIHJhd1JlbW92ZUNoaWxkLmNhbGwoY29udGFpbmVyLCBhdHRhY2hlZEVsZW1lbnQpOwogICAgICB9CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIGNvbnNvbGUud2FybihlKTsKICAgIH0KCiAgICByZXR1cm4gaGVhZE9yQm9keVJlbW92ZUNoaWxkLmNhbGwodGhpcywgY2hpbGQpOwogIH07Cn0KCmV4cG9ydCBmdW5jdGlvbiBwYXRjaEhUTUxEeW5hbWljQXBwZW5kUHJvdG90eXBlRnVuY3Rpb25zKGlzSW52b2tlZEJ5TWljcm9BcHAsIGNvbnRhaW5lckNvbmZpZ0dldHRlcikgewogIC8vIEp1c3Qgb3ZlcndyaXRlIGl0IHdoaWxlIGl0IGhhdmUgbm90IGJlZW4gb3ZlcndyaXRlCiAgaWYgKEhUTUxIZWFkRWxlbWVudC5wcm90b3R5cGUuYXBwZW5kQ2hpbGQgPT09IHJhd0hlYWRBcHBlbmRDaGlsZCAmJiBIVE1MQm9keUVsZW1lbnQucHJvdG90eXBlLmFwcGVuZENoaWxkID09PSByYXdCb2R5QXBwZW5kQ2hpbGQgJiYgSFRNTEhlYWRFbGVtZW50LnByb3RvdHlwZS5pbnNlcnRCZWZvcmUgPT09IHJhd0hlYWRJbnNlcnRCZWZvcmUpIHsKICAgIEhUTUxIZWFkRWxlbWVudC5wcm90b3R5cGUuYXBwZW5kQ2hpbGQgPSBnZXRPdmVyd3JpdHRlbkFwcGVuZENoaWxkT3JJbnNlcnRCZWZvcmUoewogICAgICByYXdET01BcHBlbmRPckluc2VydEJlZm9yZTogcmF3SGVhZEFwcGVuZENoaWxkLAogICAgICBjb250YWluZXJDb25maWdHZXR0ZXI6IGNvbnRhaW5lckNvbmZpZ0dldHRlciwKICAgICAgaXNJbnZva2VkQnlNaWNyb0FwcDogaXNJbnZva2VkQnlNaWNyb0FwcAogICAgfSk7CiAgICBIVE1MQm9keUVsZW1lbnQucHJvdG90eXBlLmFwcGVuZENoaWxkID0gZ2V0T3ZlcndyaXR0ZW5BcHBlbmRDaGlsZE9ySW5zZXJ0QmVmb3JlKHsKICAgICAgcmF3RE9NQXBwZW5kT3JJbnNlcnRCZWZvcmU6IHJhd0JvZHlBcHBlbmRDaGlsZCwKICAgICAgY29udGFpbmVyQ29uZmlnR2V0dGVyOiBjb250YWluZXJDb25maWdHZXR0ZXIsCiAgICAgIGlzSW52b2tlZEJ5TWljcm9BcHA6IGlzSW52b2tlZEJ5TWljcm9BcHAKICAgIH0pOwogICAgSFRNTEhlYWRFbGVtZW50LnByb3RvdHlwZS5pbnNlcnRCZWZvcmUgPSBnZXRPdmVyd3JpdHRlbkFwcGVuZENoaWxkT3JJbnNlcnRCZWZvcmUoewogICAgICByYXdET01BcHBlbmRPckluc2VydEJlZm9yZTogcmF3SGVhZEluc2VydEJlZm9yZSwKICAgICAgY29udGFpbmVyQ29uZmlnR2V0dGVyOiBjb250YWluZXJDb25maWdHZXR0ZXIsCiAgICAgIGlzSW52b2tlZEJ5TWljcm9BcHA6IGlzSW52b2tlZEJ5TWljcm9BcHAKICAgIH0pOwogIH0gLy8gSnVzdCBvdmVyd3JpdGUgaXQgd2hpbGUgaXQgaGF2ZSBub3QgYmVlbiBvdmVyd3JpdGUKCgogIGlmIChIVE1MSGVhZEVsZW1lbnQucHJvdG90eXBlLnJlbW92ZUNoaWxkID09PSByYXdIZWFkUmVtb3ZlQ2hpbGQgJiYgSFRNTEJvZHlFbGVtZW50LnByb3RvdHlwZS5yZW1vdmVDaGlsZCA9PT0gcmF3Qm9keVJlbW92ZUNoaWxkKSB7CiAgICBIVE1MSGVhZEVsZW1lbnQucHJvdG90eXBlLnJlbW92ZUNoaWxkID0gZ2V0TmV3UmVtb3ZlQ2hpbGQocmF3SGVhZFJlbW92ZUNoaWxkLCBmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICByZXR1cm4gY29udGFpbmVyQ29uZmlnR2V0dGVyKGVsZW1lbnQpLmFwcFdyYXBwZXJHZXR0ZXI7CiAgICB9KTsKICAgIEhUTUxCb2R5RWxlbWVudC5wcm90b3R5cGUucmVtb3ZlQ2hpbGQgPSBnZXROZXdSZW1vdmVDaGlsZChyYXdCb2R5UmVtb3ZlQ2hpbGQsIGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgIHJldHVybiBjb250YWluZXJDb25maWdHZXR0ZXIoZWxlbWVudCkuYXBwV3JhcHBlckdldHRlcjsKICAgIH0pOwogIH0KCiAgcmV0dXJuIGZ1bmN0aW9uIHVucGF0Y2goKSB7CiAgICBIVE1MSGVhZEVsZW1lbnQucHJvdG90eXBlLmFwcGVuZENoaWxkID0gcmF3SGVhZEFwcGVuZENoaWxkOwogICAgSFRNTEhlYWRFbGVtZW50LnByb3RvdHlwZS5yZW1vdmVDaGlsZCA9IHJhd0hlYWRSZW1vdmVDaGlsZDsKICAgIEhUTUxCb2R5RWxlbWVudC5wcm90b3R5cGUuYXBwZW5kQ2hpbGQgPSByYXdCb2R5QXBwZW5kQ2hpbGQ7CiAgICBIVE1MQm9keUVsZW1lbnQucHJvdG90eXBlLnJlbW92ZUNoaWxkID0gcmF3Qm9keVJlbW92ZUNoaWxkOwogICAgSFRNTEhlYWRFbGVtZW50LnByb3RvdHlwZS5pbnNlcnRCZWZvcmUgPSByYXdIZWFkSW5zZXJ0QmVmb3JlOwogIH07Cn0KZXhwb3J0IGZ1bmN0aW9uIHJlYnVpbGRDU1NSdWxlcyhzdHlsZVNoZWV0RWxlbWVudHMsIHJlQXBwZW5kRWxlbWVudCkgewogIHN0eWxlU2hlZXRFbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChzdHlsZXNoZWV0RWxlbWVudCkgewogICAgLy8gcmUtYXBwZW5kIHRoZSBkeW5hbWljIHN0eWxlc2hlZXQgdG8gc3ViLWFwcCBjb250YWluZXIKICAgIHZhciBhcHBlbmRTdWNjZXNzID0gcmVBcHBlbmRFbGVtZW50KHN0eWxlc2hlZXRFbGVtZW50KTsKCiAgICBpZiAoYXBwZW5kU3VjY2VzcykgewogICAgICAvKgogICAgICBnZXQgdGhlIHN0b3JlZCBjc3MgcnVsZXMgZnJvbSBzdHlsZWQtY29tcG9uZW50cyBnZW5lcmF0ZWQgZWxlbWVudCwgYW5kIHRoZSByZS1pbnNlcnQgcnVsZXMgZm9yIHRoZW0uCiAgICAgIG5vdGUgdGhhdCB3ZSBtdXN0IGRvIHRoaXMgYWZ0ZXIgc3R5bGUgZWxlbWVudCBoYWQgYmVlbiBhZGRlZCB0byBkb2N1bWVudCwgd2hpY2ggc3R5bGVzaGVldCB3b3VsZCBiZSBhc3NvY2lhdGVkIHRvIHRoZSBkb2N1bWVudCBhdXRvbWF0aWNhbGx5LgogICAgICBjaGVjayB0aGUgc3BlYyBodHRwczovL3d3dy53My5vcmcvVFIvY3Nzb20tMS8jYXNzb2NpYXRlZC1jc3Mtc3R5bGUtc2hlZXQKICAgICAgICovCiAgICAgIGlmIChzdHlsZXNoZWV0RWxlbWVudCBpbnN0YW5jZW9mIEhUTUxTdHlsZUVsZW1lbnQgJiYgaXNTdHlsZWRDb21wb25lbnRzTGlrZShzdHlsZXNoZWV0RWxlbWVudCkpIHsKICAgICAgICB2YXIgY3NzUnVsZXMgPSBnZXRTdHlsZWRFbGVtZW50Q1NTUnVsZXMoc3R5bGVzaGVldEVsZW1lbnQpOwoKICAgICAgICBpZiAoY3NzUnVsZXMpIHsKICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wbHVzcGx1cwogICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjc3NSdWxlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB2YXIgY3NzUnVsZSA9IGNzc1J1bGVzW2ldOwogICAgICAgICAgICB2YXIgY3NzU3R5bGVTaGVldEVsZW1lbnQgPSBzdHlsZXNoZWV0RWxlbWVudC5zaGVldDsKICAgICAgICAgICAgY3NzU3R5bGVTaGVldEVsZW1lbnQuaW5zZXJ0UnVsZShjc3NSdWxlLmNzc1RleHQsIGNzc1N0eWxlU2hlZXRFbGVtZW50LmNzc1J1bGVzLmxlbmd0aCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSk7Cn0="},{"version":3,"sources":["D:/qiankun微前台/Demo/qiankun/qiankun-base/node_modules/qiankun/es/sandbox/patchers/dynamicAppend/common.js"],"names":["_isFunction","execScripts","frameworkConfiguration","css","rawHeadAppendChild","HTMLHeadElement","prototype","appendChild","rawHeadRemoveChild","removeChild","rawBodyAppendChild","HTMLBodyElement","rawBodyRemoveChild","rawHeadInsertBefore","insertBefore","rawRemoveChild","HTMLElement","SCRIPT_TAG_NAME","LINK_TAG_NAME","STYLE_TAG_NAME","isHijackingTag","tagName","toUpperCase","isStyledComponentsLike","element","_a","_b","textContent","sheet","cssRules","length","getStyledElementCSSRules","patchCustomEvent","e","elementGetter","Object","defineProperties","srcElement","get","target","manualInvokeElementOnLoad","loadEvent","CustomEvent","patchedEvent","onload","dispatchEvent","manualInvokeElementOnError","errorEvent","onerror","convertLinkAsStyle","postProcess","fetchFn","arguments","undefined","fetch","styleElement","document","createElement","href","dataset","qiankunHref","then","res","text","styleContext","createTextNode","catch","styledComponentCSSRulesMap","WeakMap","dynamicScriptAttachedCommentMap","dynamicLinkAttachedInlineStyleMap","recordStyledComponentsCSSRules","styleElements","forEach","HTMLStyleElement","set","styledElement","getOverwrittenAppendChildOrInsertBefore","opts","appendChildOrInsertBefore","newChild","refChild","rawDOMAppendOrInsertBefore","isInvokedByMicroApp","containerConfigGetter","call","containerConfig","appName","appWrapperGetter","proxy","strictGlobal","dynamicStyleSheetElements","scopedCSS","excludeAssetFilter","stylesheetElement","_stylesheetElement","mountDOM","linkElementUsingStylesheet","rel","_fetch","fn","process","push","referenceNode","contains","_element","src","_mountDOM","_fetch2","_referenceNode","beforeExec","isCurrentScriptConfigurable","descriptor","getOwnPropertyDescriptor","configurable","defineProperty","success","error","dynamicScriptCommentElement","createComment","concat","dynamicInlineScriptCommentElement","getNewRemoveChild","headOrBodyRemoveChild","appWrapperGetterGetter","child","attachedElement","container","console","warn","patchHTMLDynamicAppendPrototypeFunctions","unpatch","rebuildCSSRules","styleSheetElements","reAppendElement","appendSuccess","i","cssRule","cssStyleSheetElement","insertRule","cssText"],"mappings":"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","sourcesContent":["import _isFunction from \"lodash/isFunction\";\n\n/**\n * @author Kuitos\n * @since 2019-10-21\n */\nimport { execScripts } from 'import-html-entry';\nimport { frameworkConfiguration } from '../../../apis';\nimport * as css from '../css';\nexport var rawHeadAppendChild = HTMLHeadElement.prototype.appendChild;\nvar rawHeadRemoveChild = HTMLHeadElement.prototype.removeChild;\nvar rawBodyAppendChild = HTMLBodyElement.prototype.appendChild;\nvar rawBodyRemoveChild = HTMLBodyElement.prototype.removeChild;\nvar rawHeadInsertBefore = HTMLHeadElement.prototype.insertBefore;\nvar rawRemoveChild = HTMLElement.prototype.removeChild;\nvar SCRIPT_TAG_NAME = 'SCRIPT';\nvar LINK_TAG_NAME = 'LINK';\nvar STYLE_TAG_NAME = 'STYLE';\nexport function isHijackingTag(tagName) {\n  return (tagName === null || tagName === void 0 ? void 0 : tagName.toUpperCase()) === LINK_TAG_NAME || (tagName === null || tagName === void 0 ? void 0 : tagName.toUpperCase()) === STYLE_TAG_NAME || (tagName === null || tagName === void 0 ? void 0 : tagName.toUpperCase()) === SCRIPT_TAG_NAME;\n}\n/**\n * Check if a style element is a styled-component liked.\n * A styled-components liked element is which not have textContext but keep the rules in its styleSheet.cssRules.\n * Such as the style element generated by styled-components and emotion.\n * @param element\n */\n\nexport function isStyledComponentsLike(element) {\n  var _a, _b;\n\n  return !element.textContent && (((_a = element.sheet) === null || _a === void 0 ? void 0 : _a.cssRules.length) || ((_b = getStyledElementCSSRules(element)) === null || _b === void 0 ? void 0 : _b.length));\n}\n\nfunction patchCustomEvent(e, elementGetter) {\n  Object.defineProperties(e, {\n    srcElement: {\n      get: elementGetter\n    },\n    target: {\n      get: elementGetter\n    }\n  });\n  return e;\n}\n\nfunction manualInvokeElementOnLoad(element) {\n  // we need to invoke the onload event manually to notify the event listener that the script was completed\n  // here are the two typical ways of dynamic script loading\n  // 1. element.onload callback way, which webpack and loadjs used, see https://github.com/muicss/loadjs/blob/master/src/loadjs.js#L138\n  // 2. addEventListener way, which toast-loader used, see https://github.com/pyrsmk/toast/blob/master/src/Toast.ts#L64\n  var loadEvent = new CustomEvent('load');\n  var patchedEvent = patchCustomEvent(loadEvent, function () {\n    return element;\n  });\n\n  if (_isFunction(element.onload)) {\n    element.onload(patchedEvent);\n  } else {\n    element.dispatchEvent(patchedEvent);\n  }\n}\n\nfunction manualInvokeElementOnError(element) {\n  var errorEvent = new CustomEvent('error');\n  var patchedEvent = patchCustomEvent(errorEvent, function () {\n    return element;\n  });\n\n  if (_isFunction(element.onerror)) {\n    element.onerror(patchedEvent);\n  } else {\n    element.dispatchEvent(patchedEvent);\n  }\n}\n\nfunction convertLinkAsStyle(element, postProcess) {\n  var fetchFn = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : fetch;\n  var styleElement = document.createElement('style');\n  var href = element.href; // add source link element href\n\n  styleElement.dataset.qiankunHref = href;\n  fetchFn(href).then(function (res) {\n    return res.text();\n  }).then(function (styleContext) {\n    styleElement.appendChild(document.createTextNode(styleContext));\n    postProcess(styleElement);\n    manualInvokeElementOnLoad(element);\n  }).catch(function () {\n    return manualInvokeElementOnError(element);\n  });\n  return styleElement;\n}\n\nvar styledComponentCSSRulesMap = new WeakMap();\nvar dynamicScriptAttachedCommentMap = new WeakMap();\nvar dynamicLinkAttachedInlineStyleMap = new WeakMap();\nexport function recordStyledComponentsCSSRules(styleElements) {\n  styleElements.forEach(function (styleElement) {\n    /*\n     With a styled-components generated style element, we need to record its cssRules for restore next re-mounting time.\n     We're doing this because the sheet of style element is going to be cleaned automatically by browser after the style element dom removed from document.\n     see https://www.w3.org/TR/cssom-1/#associated-css-style-sheet\n     */\n    if (styleElement instanceof HTMLStyleElement && isStyledComponentsLike(styleElement)) {\n      if (styleElement.sheet) {\n        // record the original css rules of the style element for restore\n        styledComponentCSSRulesMap.set(styleElement, styleElement.sheet.cssRules);\n      }\n    }\n  });\n}\nexport function getStyledElementCSSRules(styledElement) {\n  return styledComponentCSSRulesMap.get(styledElement);\n}\n\nfunction getOverwrittenAppendChildOrInsertBefore(opts) {\n  return function appendChildOrInsertBefore(newChild, refChild) {\n    var _a, _b;\n\n    var element = newChild;\n    var rawDOMAppendOrInsertBefore = opts.rawDOMAppendOrInsertBefore,\n        isInvokedByMicroApp = opts.isInvokedByMicroApp,\n        containerConfigGetter = opts.containerConfigGetter;\n\n    if (!isHijackingTag(element.tagName) || !isInvokedByMicroApp(element)) {\n      return rawDOMAppendOrInsertBefore.call(this, element, refChild);\n    }\n\n    if (element.tagName) {\n      var containerConfig = containerConfigGetter(element);\n      var appName = containerConfig.appName,\n          appWrapperGetter = containerConfig.appWrapperGetter,\n          proxy = containerConfig.proxy,\n          strictGlobal = containerConfig.strictGlobal,\n          dynamicStyleSheetElements = containerConfig.dynamicStyleSheetElements,\n          scopedCSS = containerConfig.scopedCSS,\n          excludeAssetFilter = containerConfig.excludeAssetFilter;\n\n      switch (element.tagName) {\n        case LINK_TAG_NAME:\n        case STYLE_TAG_NAME:\n          {\n            var stylesheetElement = newChild;\n            var _stylesheetElement = stylesheetElement,\n                href = _stylesheetElement.href;\n\n            if (excludeAssetFilter && href && excludeAssetFilter(href)) {\n              return rawDOMAppendOrInsertBefore.call(this, element, refChild);\n            }\n\n            var mountDOM = appWrapperGetter();\n\n            if (scopedCSS) {\n              // exclude link elements like <link rel=\"icon\" href=\"favicon.ico\">\n              var linkElementUsingStylesheet = ((_a = element.tagName) === null || _a === void 0 ? void 0 : _a.toUpperCase()) === LINK_TAG_NAME && element.rel === 'stylesheet' && element.href;\n\n              if (linkElementUsingStylesheet) {\n                var _fetch = typeof frameworkConfiguration.fetch === 'function' ? frameworkConfiguration.fetch : (_b = frameworkConfiguration.fetch) === null || _b === void 0 ? void 0 : _b.fn;\n\n                stylesheetElement = convertLinkAsStyle(element, function (styleElement) {\n                  return css.process(mountDOM, styleElement, appName);\n                }, _fetch);\n                dynamicLinkAttachedInlineStyleMap.set(element, stylesheetElement);\n              } else {\n                css.process(mountDOM, stylesheetElement, appName);\n              }\n            } // eslint-disable-next-line no-shadow\n\n\n            dynamicStyleSheetElements.push(stylesheetElement);\n            var referenceNode = mountDOM.contains(refChild) ? refChild : null;\n            return rawDOMAppendOrInsertBefore.call(mountDOM, stylesheetElement, referenceNode);\n          }\n\n        case SCRIPT_TAG_NAME:\n          {\n            var _element = element,\n                src = _element.src,\n                text = _element.text; // some script like jsonp maybe not support cors which should't use execScripts\n\n            if (excludeAssetFilter && src && excludeAssetFilter(src)) {\n              return rawDOMAppendOrInsertBefore.call(this, element, refChild);\n            }\n\n            var _mountDOM = appWrapperGetter();\n\n            var _fetch2 = frameworkConfiguration.fetch;\n\n            var _referenceNode = _mountDOM.contains(refChild) ? refChild : null;\n\n            if (src) {\n              execScripts(null, [src], proxy, {\n                fetch: _fetch2,\n                strictGlobal: strictGlobal,\n                beforeExec: function beforeExec() {\n                  var isCurrentScriptConfigurable = function isCurrentScriptConfigurable() {\n                    var descriptor = Object.getOwnPropertyDescriptor(document, 'currentScript');\n                    return !descriptor || descriptor.configurable;\n                  };\n\n                  if (isCurrentScriptConfigurable()) {\n                    Object.defineProperty(document, 'currentScript', {\n                      get: function get() {\n                        return element;\n                      },\n                      configurable: true\n                    });\n                  }\n                },\n                success: function success() {\n                  manualInvokeElementOnLoad(element);\n                  element = null;\n                },\n                error: function error() {\n                  manualInvokeElementOnError(element);\n                  element = null;\n                }\n              });\n              var dynamicScriptCommentElement = document.createComment(\"dynamic script \".concat(src, \" replaced by qiankun\"));\n              dynamicScriptAttachedCommentMap.set(element, dynamicScriptCommentElement);\n              return rawDOMAppendOrInsertBefore.call(_mountDOM, dynamicScriptCommentElement, _referenceNode);\n            } // inline script never trigger the onload and onerror event\n\n\n            execScripts(null, [\"<script>\".concat(text, \"</script>\")], proxy, {\n              strictGlobal: strictGlobal\n            });\n            var dynamicInlineScriptCommentElement = document.createComment('dynamic inline script replaced by qiankun');\n            dynamicScriptAttachedCommentMap.set(element, dynamicInlineScriptCommentElement);\n            return rawDOMAppendOrInsertBefore.call(_mountDOM, dynamicInlineScriptCommentElement, _referenceNode);\n          }\n\n        default:\n          break;\n      }\n    }\n\n    return rawDOMAppendOrInsertBefore.call(this, element, refChild);\n  };\n}\n\nfunction getNewRemoveChild(headOrBodyRemoveChild, appWrapperGetterGetter) {\n  return function removeChild(child) {\n    var tagName = child.tagName;\n    if (!isHijackingTag(tagName)) return headOrBodyRemoveChild.call(this, child);\n\n    try {\n      var attachedElement;\n\n      switch (tagName) {\n        case LINK_TAG_NAME:\n          {\n            attachedElement = dynamicLinkAttachedInlineStyleMap.get(child) || child;\n            break;\n          }\n\n        case SCRIPT_TAG_NAME:\n          {\n            attachedElement = dynamicScriptAttachedCommentMap.get(child) || child;\n            break;\n          }\n\n        default:\n          {\n            attachedElement = child;\n          }\n      } // container may had been removed while app unmounting if the removeChild action was async\n\n\n      var appWrapperGetter = appWrapperGetterGetter(child);\n      var container = appWrapperGetter();\n\n      if (container.contains(attachedElement)) {\n        return rawRemoveChild.call(container, attachedElement);\n      }\n    } catch (e) {\n      console.warn(e);\n    }\n\n    return headOrBodyRemoveChild.call(this, child);\n  };\n}\n\nexport function patchHTMLDynamicAppendPrototypeFunctions(isInvokedByMicroApp, containerConfigGetter) {\n  // Just overwrite it while it have not been overwrite\n  if (HTMLHeadElement.prototype.appendChild === rawHeadAppendChild && HTMLBodyElement.prototype.appendChild === rawBodyAppendChild && HTMLHeadElement.prototype.insertBefore === rawHeadInsertBefore) {\n    HTMLHeadElement.prototype.appendChild = getOverwrittenAppendChildOrInsertBefore({\n      rawDOMAppendOrInsertBefore: rawHeadAppendChild,\n      containerConfigGetter: containerConfigGetter,\n      isInvokedByMicroApp: isInvokedByMicroApp\n    });\n    HTMLBodyElement.prototype.appendChild = getOverwrittenAppendChildOrInsertBefore({\n      rawDOMAppendOrInsertBefore: rawBodyAppendChild,\n      containerConfigGetter: containerConfigGetter,\n      isInvokedByMicroApp: isInvokedByMicroApp\n    });\n    HTMLHeadElement.prototype.insertBefore = getOverwrittenAppendChildOrInsertBefore({\n      rawDOMAppendOrInsertBefore: rawHeadInsertBefore,\n      containerConfigGetter: containerConfigGetter,\n      isInvokedByMicroApp: isInvokedByMicroApp\n    });\n  } // Just overwrite it while it have not been overwrite\n\n\n  if (HTMLHeadElement.prototype.removeChild === rawHeadRemoveChild && HTMLBodyElement.prototype.removeChild === rawBodyRemoveChild) {\n    HTMLHeadElement.prototype.removeChild = getNewRemoveChild(rawHeadRemoveChild, function (element) {\n      return containerConfigGetter(element).appWrapperGetter;\n    });\n    HTMLBodyElement.prototype.removeChild = getNewRemoveChild(rawBodyRemoveChild, function (element) {\n      return containerConfigGetter(element).appWrapperGetter;\n    });\n  }\n\n  return function unpatch() {\n    HTMLHeadElement.prototype.appendChild = rawHeadAppendChild;\n    HTMLHeadElement.prototype.removeChild = rawHeadRemoveChild;\n    HTMLBodyElement.prototype.appendChild = rawBodyAppendChild;\n    HTMLBodyElement.prototype.removeChild = rawBodyRemoveChild;\n    HTMLHeadElement.prototype.insertBefore = rawHeadInsertBefore;\n  };\n}\nexport function rebuildCSSRules(styleSheetElements, reAppendElement) {\n  styleSheetElements.forEach(function (stylesheetElement) {\n    // re-append the dynamic stylesheet to sub-app container\n    var appendSuccess = reAppendElement(stylesheetElement);\n\n    if (appendSuccess) {\n      /*\n      get the stored css rules from styled-components generated element, and the re-insert rules for them.\n      note that we must do this after style element had been added to document, which stylesheet would be associated to the document automatically.\n      check the spec https://www.w3.org/TR/cssom-1/#associated-css-style-sheet\n       */\n      if (stylesheetElement instanceof HTMLStyleElement && isStyledComponentsLike(stylesheetElement)) {\n        var cssRules = getStyledElementCSSRules(stylesheetElement);\n\n        if (cssRules) {\n          // eslint-disable-next-line no-plusplus\n          for (var i = 0; i < cssRules.length; i++) {\n            var cssRule = cssRules[i];\n            var cssStyleSheetElement = stylesheetElement.sheet;\n            cssStyleSheetElement.insertRule(cssRule.cssText, cssStyleSheetElement.cssRules.length);\n          }\n        }\n      }\n    }\n  });\n}"]}]}